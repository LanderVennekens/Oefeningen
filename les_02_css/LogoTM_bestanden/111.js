(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[111],{2744:function(e,t,n){"use strict";n.d(t,"y",function(){return r}),n.d(t,"v",function(){return o}),n.d(t,"p",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"o",function(){return d}),n.d(t,"m",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"a",function(){return f}),n.d(t,"n",function(){return p}),n.d(t,"i",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"r",function(){return h}),n.d(t,"s",function(){return b}),n.d(t,"l",function(){return g}),n.d(t,"u",function(){return v}),n.d(t,"f",function(){return y}),n.d(t,"d",function(){return S}),n.d(t,"g",function(){return D}),n.d(t,"b",function(){return I}),n.d(t,"_",function(){return x}),n.d(t,"h",function(){return C}),n.d(t,"I",function(){return O}),n.d(t,"S",function(){return w}),n.d(t,"D",function(){return E});var a=n(222),i=n(5),r=a.n.isFeatureEnabled,o={ODB:817,ODC:!0,OneDrive:!0},s={ODB:60124,ODC:"UseMsPdfViewer",OneDrive:!1,Fallback:!1},c={ODB:60358},d={ODB:1655,ODC:!1,OneDrive:!1,Fallback:!1},l={ECS:1071224},u={ECS:1082725},f={ECS:1111474},p={ECS:1116309},m={ECS:1125492},_={ECS:1126891},h={ODB:1614,ODC:!1,OneDrive:!1,Fallback:!1},b={ODB:1063,ODC:!1,OneDrive:!1,Fallback:!1},g={ODB:1513,ODC:!1,OneDrive:!1,Fallback:!1},v={ODB:60165},y={ODB:60192},S={ODB:61066},D={ODB:1355,ODC:!1,OneDrive:!1,Fallback:!1},I={ODB:61094,ODC:!1,OneDrive:!1,Fallback:!1},x={ODB:!i.e.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),ODC:!0},C={ODB:!0,OneDrive:!0},O={ODB:61113},w={ODB:61125},E={ODB:61217}},3050:function(e,t,n){"use strict";n.d(t,"e",function(){return S}),n.d(t,"t",function(){return D});var a=n(0),i=n(178),r=n(59),o=n(188),s=n(226),c=n(687),d=n(3159),l=n(175),u=n(2744),f=n(3219),p=n(87),m=n(46),_=n(949),h=n(3188),b=n(3221),g=n(3220),v=".pdf",y=["ODBLightSpeedWebPack"],S=function(){function e(e,t){this._enablePdf=Object(u.y)(u.v),this._enableMsPdfviewer=Object(u.y)(u.p),this._enableEmbedMsPdfviewer=Object(u.y)(u.o),this._enableEditPdf=Object(u.y)(u.r),this._enableExtractPdf=Object(u.y)(u.l),this._enablePreviewTif=Object(u.y)(u._),this._enableHTML=Object(u.y)(u.h)&&(Object(f.e)()||t.platformDetection.isEdge),this._urlDataSource=t.urlDataSource,this._pdfDataSource=t.pdfDataSource,this._navigation=t.navigation,this._viewParams=this._navigation.viewParams,this._pageContext=t.pageContext,this._embedOptions=t.embedOptions}return e.isWasmSupported=function(){if(void 0===e._isWasmSupported){var t=!1;try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var n=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));n instanceof WebAssembly.Module&&(t=new WebAssembly.Instance(n)instanceof WebAssembly.Instance)}}catch(e){}e._isWasmSupported=t}return e._isWasmSupported},e.prototype.isNotEmbed=function(){return this._urlDataSource.getPageType(this._viewParams)!==l.e.Embed},e.prototype.isSupportedFileType=function(e){var t=this._extension(e);return this._enablePdf&&(t===v||".ai"===t||!!e.pdfConversion)&&(this._enablePreviewTif||".tif"!==t&&".tiff"!==t)},e.prototype.isMsPdfViewerSupported=function(e){var t;if(!e)return!1;var n=this._enableMsPdfviewer&&(this.isNotEmbed()||this._enableEmbedMsPdfviewer),a=this._isHostAppTeams()&&Object(g.e)(u.m.ECS),i=!Object(b.a)()&&!Object(g.t)(u.e.ECS)&&!this.isNotEmbed()&&((null===(t=this._embedOptions)||void 0===t?void 0:t.useMsPdf)||!1);return(n||a||i)&&this._isMsPdfViewerSupported(e)},e.prototype.isMsPdfViewerAvailable=function(e){return this.isSupportedFileType(e)&&this._isEnabledInOneUp(e)&&this.isMsPdfViewerSupported(e.size)},e.prototype.isPdfEditAvailable=function(e){return this.isMsPdfViewerAvailable(e)&&(this._enableEditPdf||!this.isNotEmbed()&&!Object(b.e)()&&!Object(g.t)(u.a.ECS))&&this._extension(e)===v},e.prototype.isPdfExtractAvailable=function(e){return this.hasSyntexLicense()&&this.isMsPdfViewerAvailable(e)&&this.isNotEmbed()&&this._enableExtractPdf},e.prototype.isPdfExtractable=function(){return this.hasSyntexLicense()&&this._enableExtractPdf},e.prototype.isPdfEditable=function(e){var t;return e.itemStatus!==i.t.ConditionalAccessViewOnly&&e.itemStatus!==i.t.ConditionalAccessBlocked&&(null===(t=this._pdfDataSource)||void 0===t?void 0:t.canSave({item:e}))},e.prototype.getWorkerManifestName=function(){var e,t=(null===(e=window._spModuleLink)||void 0===e?void 0:e.manifestName)||"";return Object(u.y)(u.c)&&-1!==y.indexOf(t)?"odbmspdfwebworker":"mspdfwebworker"},e.prototype.getEmbedOptions=function(){return this._embedOptions},e.prototype.hasSyntexLicense=function(){var e,t;return(null===(e=this._pageContext)||void 0===e?void 0:e.canUserUseSyntex)||Object(b.r)()&&(null===(t=this._pageContext)||void 0===t?void 0:t.isUserSyntexV2Licensed)||!1},e.prototype._isHostAppTeams=function(){if(this.isNotEmbed())return!1;var e=this._getClientId();return!!e&&-1!==["MicrosoftTeams","Microsoft Teams","Microsoft Teams Web Client","Teams Service","Teams Client App","Teams Additional Client App","Teams App"].indexOf(e)},e.prototype._isEnabledInOneUp=function(e){return!(e.officeBundle||e.wopiFrameUrl||this._enableHTML&&e.htmlConversion)},e.prototype._isMsPdfViewerSupported=function(t){if(!t)return!1;var n=t<(performance.memory?performance.memory.jsHeapSizeLimit-performance.memory.totalJSHeapSize:268435456)/4;return e.isWasmSupported()&&n},e.prototype._extension=function(e){return e&&e.extension&&e.extension.toLowerCase()||""},e.prototype._getClientId=function(){var e,t=(null===(e=this._pageContext)||void 0===e?void 0:e.authToken)||"",n=Object(c.a)(t);return n&&n.app_displayname||this._getClientIdFromQSP()},e.prototype._getClientIdFromQSP=function(){var e,t=window,n=Object(s.e)((t.location.search||"").slice(1)),i=Object(s.e)((t.location.hash||"").slice(1)),r=(null===(e=t.PageContext)||void 0===e?void 0:e.scenarioContext.embed)||{};return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},n),i),r).client_id},e.dependencies={},e}(),D=Object(r.r)("PdfViewerHelper",S,{platformDetection:o.e,urlDataSource:_.e,navigation:p.e,pdfDataSource:h.e,pageContext:m.e.optional,embedOptions:d.e.optional})},3159:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(6).t)("pdfViewerEmbedOptions")},3188:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(59),r=n(64),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.canSaveAsOriginal=function(e){var t=e.item;return!!t&&r.e.hasItemPermission(t,r.e.insertListItems)&&r.e.hasItemPermission(t,r.e.editListItems)},t.dependencies={},t}(function(){function e(){}return e.prototype.canSave=function(e){return this.canSaveAsOriginal(e)},e}()),s=Object(i.r)("PdfDataSource",o)},3218:function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l});var a=n(59),i=n(2182),r=n(356),o=n(3261),s=n(17),c=n(3050),d=function(){function e(e,t){var n=t.observablesFactoryType,a=t.viewParams,i=new n;this._corePdfViewerHelper=t.corePdfViewerHelper;var r=this.getEmbedOptions(),c=(null==r?void 0:r.allowEdit)&&(null==r?void 0:r.openInEditMode),d="ZXNpZ24"===a()[s.n.navParamKey]?o.e.Esign:c?o.e.Edit:o.e.View;this.state={isOpened:i.create(!1),currentMode:i.create(d),filePickerMode:i.create("close")}}return e.isWasmSupported=function(){return c.e.isWasmSupported()},e.prototype.isMsPdfViewerAvailable=function(e){return this._corePdfViewerHelper.isMsPdfViewerAvailable(this._convertItem(e))},e.prototype.isMsPdfViewerSupported=function(e){return this._corePdfViewerHelper.isMsPdfViewerSupported(e)},e.prototype.isNotEmbed=function(){return this._corePdfViewerHelper.isNotEmbed()},e.prototype.isPdfEditAvailable=function(e){return this._corePdfViewerHelper.isPdfEditAvailable(this._convertItem(e))},e.prototype.isPdfEditable=function(e){return this._corePdfViewerHelper.isPdfEditable(this._convertItem(e))},e.prototype.isSupportedFileType=function(e){return this._corePdfViewerHelper.isSupportedFileType(this._convertItem(e))},e.prototype.getWorkerManifestName=function(){return this._corePdfViewerHelper.getWorkerManifestName()},e.prototype.getEmbedOptions=function(){return this._corePdfViewerHelper.getEmbedOptions()},e.prototype.isPdfExtractAvailable=function(e){return this._corePdfViewerHelper.isPdfExtractAvailable(this._convertItem(e))},e.prototype.isPdfExtractable=function(){return this._corePdfViewerHelper.isPdfExtractable()},e.prototype.hasSyntexLicense=function(){return this._corePdfViewerHelper.hasSyntexLicense()},e.prototype._convertItem=function(e){return e},e.dependencies={observablesFactoryType:i.i,viewParams:r.P,corePdfViewerHelper:c.t},e}(),l=Object(a.r)("PdfViewerHelper",d)},3219:function(e,t,n){"use strict";var a;function i(){return"boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a}n.d(t,"e",function(){return i})},3220:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i});var a=function(e){var t,n,a,i;if(!e)return!1;var r=(null===(t=window.Flight)||void 0===t?void 0:t.ecsConfig)&&JSON.parse(null===(n=window.Flight)||void 0===n?void 0:n.ecsConfig),o=null===(i=null===(a=null==r?void 0:r.RolloutContext)||void 0===a?void 0:a.settings)||void 0===i?void 0:i.ODSPMicroservices_ODWeb;return o&&!0===o[e]},i=function(e){return a(e)}},3221:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"r",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"i",function(){return d});var a=n(5),i=function(){return a.e.isActivated("c3dc126d-70db-4dc6-9ad6-3ce6d59dfaca")},r=function(){return!a.e.isActivated("acc3d562-8099-40b9-ad90-f199e8fcec91","6/15/2023","Syntex V2 License check")},o=function(){return a.e.isActivated("f644d6f3-bfb2-4b67-9ea4-f2bbd98431b0","07/17/2023","Enable editing for mspdf in embed scenarios")},s=function(){return a.e.isActivated("106d45a3-37c3-42cd-95a6-8a04645f8a7b","08/07/2023","Enable host saving for embedded scenarios")},c=function(){return a.e.isActivated("ed408543-0a69-47e8-a898-31bf63f74ce6","08/28/2023","Enable sending PDF related notifications to host for embedded scenarios")},d=function(){return a.e.isActivated("7734ec9d-6955-4473-9ea5-1c21baf2af07","08/31/2023","Fix page content with some Chinese characters cannot be rendered")}},3261:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.View=0]="View",e[e.Edit=1]="Edit",e[e.Extract=2]="Extract",e[e.Esign=3]="Esign"}(a||(a={}))},3605:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(2182),i=new(n(6).t)({name:"".concat("UniversalAnnotationStateKey",".universalAnnotationState"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:{isUniversalAnnotationActive:t.create(!1),hasPreloadSucceeded:t.create(!0)},disposable:t}}}})},4134:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"n",function(){return s});var a=n(2744);function i(e,t,n,i,r){var o;return!(!(!n&&Object(a.y)(a.d)&&(null==t?void 0:t.canUserUseSyntex)&&(null==t?void 0:t.isSyntexESignatureEnabled)&&".pdf"===(null===(o=null==e?void 0:e.extension)||void 0===o?void 0:o.toLowerCase())&&i&&i())||r)}function r(e,t,n,a,r){return i(e,t,n,a,r)}function o(e,t,n,r,o){return i(e,t,n,r,o)&&Object(a.y)(a.u)}function s(e,t,n,r,o){return i(e,t,n,r,o)&&Object(a.y)(a.f)}},7032:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(2206),r=n(110),o=n(32),s=n(188),c=n(49),d=n(2214),l=n(4134),u=n(3774),f=n(193),p=n(587),m=n(3605),_=n(3218),h=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="SendForSignature",a._itemSelectionHelper=new(a.child(d.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});var i=n.isEsignPaneExpanded,r=void 0===i?a.resources.consume(u.resourceKey):i,o=n.engagement,s=void 0===o?a.resources.consume(p.e):o;return a._isEsignPaneExpanded=r,a._engagement=s,a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=this.resources.consume(c.p),n=this.resources.consume(m.e),a=this.resources.consume(_.t),i=this.resources.consume(s.e),r=n.hasPreloadSucceeded()&&n.isUniversalAnnotationActive();return Object(l.e)(e,t,r,function(){return a.isMsPdfViewerAvailable(e)},i.isMobile)},t.prototype.onExecute=function(e,t){var n=!this._isEsignPaneExpanded.peek();return this._engagement.logData({name:"SendforSignature.Click.".concat(n?"Open":"Close"),isIntentional:!0}),this._isEsignPaneExpanded(n),f.t.raise(document.body,"resize",void 0,!0),r.n.resolve({resultType:o.t.Success})},t}(i.e);t.default=h}}]);