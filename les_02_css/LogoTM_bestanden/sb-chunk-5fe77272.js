(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["mp-comp"],{"2CCo":function(t,e,i){"use strict";i.r(e);var r=i("3twC"),o=i("GtFt"),n=i("cDcd"),s=i("KmCS");const a=Object(s.regs)("searchux.focusModeDimElementParentId","O365_NavHeader");var l=i("n8h4"),u=i("m+2y"),c=i("CE7+"),d=i("EYJi");const h=Object(c.a)(()=>({dimmerOverlay:({isDarkMode:t})=>Object.assign(Object.assign({},d.b.fadeIn200),{display:"none","@media(min-width: 1030px)":{background:t?"rgba(0,0,0,0.75)":"rgba(0,0,0,0.3)",display:"block",position:"fixed",height:"100vh",width:"100vw",zIndex:9998}})}));var p={addSelectors:function(t){return{selectors:t}},shorthands:i("fkJ0").a};const{dimmerOverlay:m}=h(p);var v=Object(l.b)(t=>Object(u.b)({dimmerOverlay:m({isDarkMode:null==t?void 0:t.isDarkMode})}));const b=Object(r.a)("endButton",o.h)((function(t){const{searchBox:e,expanded:i,theme:r}=t,o=v(r);n.useEffect(()=>(i?h():p(),p),[i]);const s=t=>{var i,r,o;return null===(o=null===(r=t||(null===(i=null==e?void 0:e.getInputElement)||void 0===i?void 0:i.call(e)))||void 0===r?void 0:r.closest("form"))||void 0===o?void 0:o.closest("div")},l=()=>document.querySelector("#"+a()),u=()=>document.querySelector("#"+c),c="searchux-searchbox-focus-mode__bg";let d="0";const h=()=>{var t;if(u())return;const i=null===(t=null==e?void 0:e.getInputElement)||void 0===t?void 0:t.call(e);if(!i)return;const r=s(i);if(!r)return;const n=l();if(!n)return null;const a=document.createElement("div");a.setAttribute("id",c),a.setAttribute("class",(null==o?void 0:o.dimmerOverlay)||""),n.appendChild(a),d=r.style.zIndex,r.style.zIndex="9999"},p=()=>{const t=u(),e=l();t&&(null==e||e.removeChild(t));const i=s();i&&(i.style.zIndex=d)};return null}));e.default=b},bWJB:function(t,e,i){"use strict";var r=i("2RPO"),o=i("Puxc"),n=i("/BpZ");e.a=function(t){return"string"==typeof t||!Object(o.a)(t)&&Object(n.a)(t)&&"[object String]"==Object(r.a)(t)}},d7kI:function(t,e,i){"use strict";i.r(e);var r=i("n5ha"),o=i("GXij"),n=i("GPGK"),s=(Object(r.declareString)("search-dl.quickActions.topicCenterCmd.tooltip")),a=Object(n.a)({id:"TopicCenter",entityType:"Topic",parameters:[{name:"topic",entity:"Topic",isRequired:!0,validate:function(t){var e;return!!(null===(e=null==t?void 0:t.customProps)||void 0===e?void 0:e.url)}}],execute:function(t){var e,i=null===(e=t.topic.value.customProps)||void 0===e?void 0:e.url;return i?(Object(o.a)(i,"NewTab",window),Promise.resolve()):Promise.reject("URL is missing on topic")},additionalProps:{url:function(t){var e;return null===(e=null==t?void 0:t.customProps)||void 0===e?void 0:e.url},icon:{iconName:"OpenInNewTab"},tooltip:s}});e.default=a},ohlq:function(t,e,i){"use strict";var r=i("KmCS");e.a=Object(r.regs)("searchux.clientId","",{required:!0,tags:["session","deprecated"]})},rS7V:function(t,e,i){"use strict";i.r(e),i.d(e,"registration",(function(){return c}));var r=i("+zb2"),o=i("UlRC"),n=i("rpSO"),s=i("KmCS"),a=i("F6lS"),l=i("ArQo");let u=class{constructor(t){this.searchBox=t}getId(){return"CopilotSuggestionProvider"}createStream(t){const e=[],i=(Object(l.a)()||[]).filter(t=>"d870f6cd-4aa5-4d42-9626-ab690c041429"===t.Id)[0];if(!i)return o.Observable.fromArray(e);const r=/^\s*(what|where|who|how|when)(\b|$)/i;if(t&&"Tell me more about"!==t.trim()&&!t.match(r)){const r=t.replace(new RegExp("^Tell me more about"),"").trim();e.push({id:(e.length+1).toString(),uniqueId:i.Id,icon:i.IconAnonymousUrl,url:"",displayText:"Tell me more about",searchText:r,logProps:{traceId:"some-guid"}})}else t&&t.match(r)&&e.push({id:(e.length+1).toString(),uniqueId:i.Id,icon:i.IconAnonymousUrl,url:"",displayText:"Ask about",searchText:t,logProps:{traceId:"some-guid"}});return e.push({id:(e.length+1).toString(),uniqueId:i.Id,icon:i.IconAnonymousUrl,url:"",displayText:"Ask about anything in your organization",searchText:"",logProps:{traceId:"some-guid"}}),o.Observable.fromArray(e)}};u=Object(r.__decorate)([Object(r.__param)(0,Object(n.a)("searchBox"))],u),e.default=u;const c=Object(s.regs)(a.a+".copilot",u)},tYNB:function(t,e,i){"use strict";i.r(e);var r=i("A9an"),o=i("kdYW"),n=i("5SaU"),s=i("BsjR"),a=i("cDcd");const l=t=>({primaryText:{color:t.palette.neutralPrimary,selectors:{"& div":{color:t.palette.neutralPrimary}}},wrapper:[{height:24,maxWidth:"200px",marginBottom:0,marginTop:3,background:t.palette.neutralLighter,selectors:{":hover":{background:t.palette.neutralLight}},boxSizing:"content-box",border:"1px solid #eaeaea"}],persona:{height:24},actionWrapper:{display:"flex",alignItems:"center",width:24,height:24,selectors:{"& > button":{color:t.palette.neutralPrimary,height:16,width:16,selectors:{":hover":{color:t.palette.neutralPrimary}}},"& i":{fontSize:14}}}}),u={role:null,ariaHaspopup:null,ariaAutocomplete:null,ariaLabel:null,ariaExpanded:null};function c(t,e){if(!t||t instanceof HTMLDocument)return;const i=t;return i.tagName===e.toUpperCase()?i:c(i.parentNode,e)}class d extends a.PureComponent{constructor(t,e){super(t,e),this.meetingIcon="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2048 2048' class='svg_dd790ee3' focusable='false'%3E%3Cpath d='M768 768h128v128H768V768zm384 768h128v128h-128v-128zm384-768h128v128h-128V768zm-384 0h128v128h-128V768zm-384 256h128v128H768v-128zm-384 0h128v128H384v-128zm1152 0h128v128h-128v-128zm-384 0h128v128h-128v-128zm-384 256h128v128H768v-128zm-384 0h128v128H384v-128zm1152 0h128v128h-128v-128zm-384 0h128v128h-128v-128zm-384 256h128v128H768v-128zm-384 0h128v128H384v-128zM2048 128v1792H0V128h384V0h128v128h1024V0h128v128h384zM128 256v256h1792V256h-256v128h-128V256H512v128H384V256H128zm1792 1536V640H128v1152h1792z'%3E%3C/path%3E%3C/svg%3E",this.meetingPillRef=a.createRef(),this.state={prevInputAttrs:u,isPillEnabled:!1},this.isCursorPositionAtStart=this.isCursorPositionAtStart.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.withForm=this.withForm.bind(this),this.focusPillActionButton=this.focusPillActionButton.bind(this),this.removePillOnBackspace=this.removePillOnBackspace.bind(this),this.removePill=this.removePill.bind(this),this.focusSearchBox=this.focusSearchBox.bind(this),this.selectAllInputText=this.selectAllInputText.bind(this),this.controlSearchInputAttributes=this.controlSearchInputAttributes.bind(this),this.getPreviousInputAttributes=this.getPreviousInputAttributes.bind(this),this.controlSearchInputAriaExpanded=this.controlSearchInputAriaExpanded.bind(this)}componentDidUpdate(){this.withForm(this.controlSearchInputAriaExpanded)}componentWillUnmount(){var t;window.removeEventListener("keydown",this.handleKeyDown,!1),this.setState({isPillEnabled:!1},()=>this.withForm(this.controlSearchInputAttributes)),null===(t=this.props.searchBox)||void 0===t||t.setFilled(!1)}componentDidMount(){var t;this.setState({prevInputAttrs:this.withForm(this.getPreviousInputAttributes)||u,isPillEnabled:!0},()=>this.withForm(this.controlSearchInputAttributes)),window.addEventListener("keydown",this.handleKeyDown,!1),null===(t=this.props.searchBox)||void 0===t||t.setFilled(!0)}getPreviousInputAttributes({input:t}){return t?{ariaLabel:t.getAttribute("aria-label"),role:t.getAttribute("role"),ariaHaspopup:t.getAttribute("aria-haspopup"),ariaExpanded:t.getAttribute("aria-expanded"),ariaAutocomplete:t.getAttribute("aria-autocomplete")}:u}removePill(){var t;const e=null!==(t=this.props.searchText)&&void 0!==t?t:"";window.setTimeout(()=>{var t,i;null===(t=this.props.searchBox)||void 0===t||t.submitSearch(e,{type:"unscope",scopeType:"meeting"}),this.focusSearchBox(),null===(i=this.props.searchBox)||void 0===i||i.setFilled(!1)},0)}withForm(t,e){if(!this.meetingPillRef.current)return;const i=c(this.meetingPillRef.current,"form"),r=i.querySelector(this.props.inputFieldIdentifier||'input[type="search"]');return i&&t({form:i,input:r,e:e})}isCursorPositionAtStart(t){return Boolean(t&&null!==t.selectionStart&&(null!==t.selectionEnd&&t.selectionEnd>t.selectionStart||t.selectionStart>0))}handleKeyDown(t){!Object(s.a)(this.props.searchBox)&&this.props.meetingPillData&&this.withForm(t.keyCode===n.e?this.removePillOnBackspace:this.focusPillActionButton,t)}focusSearchBox(){window.setTimeout(()=>{var t;return null===(t=this.props.searchBox)||void 0===t?void 0:t.focus()},0)}removePillOnBackspace({input:t}){this.isCursorPositionAtStart(t)||this.removePill()}focusPillActionButton({form:t,input:e,e:i}){if(!t)return;const r=c(t.querySelector(this.props.closestPillAction||""),"button");if(document.activeElement===e){if(this.isCursorPositionAtStart(e))return;i&&i.keyCode===n.b&&(r.setAttribute("tabindex","0"),r.focus())}document.activeElement===r&&i&&i.keyCode===n.c&&(this.focusSearchBox(),this.selectAllInputText(e),r.setAttribute("tabindex","-1"))}selectAllInputText(t){t&&t.setSelectionRange(0,t.value.length)}controlSearchInputAriaExpanded({input:t}){if(!this.meetingPillRef||!t)return;const{isPillEnabled:e,prevInputAttrs:{ariaExpanded:i}}=this.state;t.setAttribute("aria-expanded",e?"false":i||"")}controlSearchInputAttributes({input:t}){if(!this.meetingPillRef||!t)return;const{isPillEnabled:e,prevInputAttrs:{role:i,ariaHaspopup:r,ariaAutocomplete:o,ariaLabel:n}}=this.state;this.controlSearchInputAriaExpanded({input:t}),t.setAttribute("role",e?"searchbox":i||""),t.setAttribute("aria-haspopup",e?"false":r||""),t.setAttribute("aria-autocomplete",e?"none":o||""),t.setAttribute("aria-label",e?"Search for meeting":n||"")}render(){var t;const e=this.props.meetingPillData,i=null===(t=this.props.theme)||void 0===t?void 0:t.themeStyles;return e&&e.meetingId?a.createElement(r.a,{ref:this.meetingPillRef,primaryText:e.displayName||"",imageUrl:this.meetingIcon,personaSize:o.c.size24,removeButtonAriaLabel:"Remove meeting from query",secondaryText:"",onRemoveItem:this.removePill,styling:l(i)}):null}}d.defaultProps={inputFieldIdentifier:'input[type="search"]',closestPillAction:'[data-icon-name="Cancel"]'};e.default=d},uFs0:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var r=i("+zb2"),o=i("cDcd"),n=i("kumM"),s=function(t){function e(e){var i=t.call(this,e)||this;return i.state={isRendered:void 0===Object(n.a)()},i}return Object(r.__extends)(e,t),e.prototype.componentDidMount=function(){var t=this,e=this.props.delay;this._timeoutId=window.setTimeout((function(){t.setState({isRendered:!0})}),e)},e.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},e.prototype.render=function(){return this.state.isRendered?o.Children.only(this.props.children):null},e.defaultProps={delay:0},e}(o.Component)}}]);