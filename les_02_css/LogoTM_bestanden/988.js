(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[988],{2878:function(e,t,n){"use strict";var a=n(1171),i=n(222),r=n(158),o=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._sharingContextInformation=e.sharingContextInformation}return e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var o=this._sharingContextInformation,s=o.isFolder,c=o.isListSharing,d=o.itemUrl,l=o.listId,u=o.listItemId,f=o.listUrl,p=o.resourceId,m=o.serverRelativeItemUrl,_=o.uniqueId,h=o.webAbsoluteUrl;if(c)return e.build().webByUrl({webUrl:h}).method("Lists",l);if(_){if(l)return e.build().webByUrl({webUrl:h}).segment("lists").method("getbyid",l).method("GetItemByUniqueId",_);var b=s?"GetFolderById":"GetFileById",g={guid:_};return e.build().webByUrl({webUrl:h}).method(b,g).segment("ListItemAllFields")}return f?e.build().webByUrl({listUrl:f}).method("GetListItem",m):d?i.n.isFeatureEnabled({ODB:1236})?e.build().webByUrl({webUrl:h}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:new r.e(d).path}).segment("ListItemAllFields"):e.build().webByUrl({webUrl:h}).method("GetFileByUrl",a.t(d)).segment("ListItemAllFields"):l&&u?e.build().webByUrl({webUrl:h}).method("Lists",l).method("GetItemById",u):e.build().webByUrl({webUrl:h}).method("GetListItemByResourceId",p)}var v;v=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var y=e.build().webByItemUrl(v).method("Lists",n);return t.isRootFolder||(y=t.properties.ID?y.method("GetItemById",t.properties.ID):y.method("GetItemByUniqueId",t.properties.uniqueId)),y},e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl},e.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){return!t.has(e.loginName)&&(t.add(e.loginName),!0)})}},e}();t.e=o},2910:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(2503),i=new a.e("share"),r=(new a.e("addToShared"),new a.e("embed")),o=(new a.e("comment"),new a.e("removeFromShared"),new a.e("addAsMountPoint"),new a.e("removeAsMountPoint"),new a.e("reportAbuse"),new a.e("requestReview"),new a.e("alertItem")),s=new a.e("alertItem")},3691:function(e,t,n){"use strict";var a=n(0),i=n(2182),r=n(2878),o=n(815),s=n(79),c=n(1415),d=n(683),l=function(e){function t(t){var n=e.call(this,t)||this;return n.resources&&(n._itemUrlHelper=n.resources.consume(d.s),n._sharingContextInformation=n.resources.consume(c.e.optional)),n._sharingDataSourceHelperCommon=new r.e({itemUrlHelper:n._getItemUrlHelper(),sharingContextInformation:n._getSharingContextInformation()}),n}return Object(a.__extends)(t,e),t.prototype.encodeSharingLink=function(e){if(!e)return e;var t=e.split("?");return o.e(t[0],!0)+(t[1]?"?".concat(t[1]):"")},t.prototype.getApiRoot=function(e,t){var n=this.getParentListId(t),a=this._getSharingContextInformation();return a&&t.isRootFolder&&(a.isListSharing=!0),this._sharingDataSourceHelperCommon.getApiRoot(e,this.convertToISPListItem(t),n)},t.prototype.getExpirationFromLink=function(e){if(e&&e.indexOf("expiration=")>-1){var t=new s.t(e).getQueryParameter("expiration");t.indexOf("Z")!==t.length-1&&(t=t.replace(/\+/g," ")+" UTC");var n=Date.parse(t);if(n)return new Date(n).toString()}return null},t.prototype.getExpirationFromSharingLinkInfo=function(e){return""!==e?e:null},t.prototype.getFileUrl=function(e){return this._getItemUrlHelper().getItemUrlParts(e.key).fullItemUrl},t.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},t.prototype._getItemUrlHelper=function(){return this._itemUrlHelper},t.prototype._getSharingContextInformation=function(){return this._sharingContextInformation},t}(i.n),u=l,f=n(5),p=n(38),m=n(2213),_=n(2600),h=function(e){function t(t){var n=e.call(this,t)||this;return n._itemParentHelper=n.resources.consume(m.e),n}return Object(a.__extends)(t,e),t.prototype.getParentListId=function(e){var t,n,a;if(f.e.isActivated("d559ae5a-9bcc-467b-93a4-3bc2c5a23451","07/14/2022","Share command for search results")||(null==e?void 0:e.queryType)!==p.e.Search){var i=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));a=i?i.list.id:e&&e.properties?e.properties.listId:null}else if(!(a=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.listId)){var r=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));a=null===(n=null==r?void 0:r.list)||void 0===n?void 0:n.id}return a},t.prototype.convertToISPListItem=function(e){return Object(_.n)(e)},t}(u);t.e=h},4654:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(110),i=n(32),r=n(59),o=n(118),s=function(){function e(e,t){this._ticketRedeemer=t.ticketRedeemer}return e.prototype.redeemItem=function(e,t,n){return this.redeemItems([e],t,n)},e.prototype.redeemItems=function(e,t,n){return e&&e.some(function(e){return e&&e.tokenNeedsRedeeming})||n?a.n.resolve(this._ticketRedeemer()).then(function(n){return n?n.startRedeem(t,e&&e[0]):{resultType:i.t.Success}}):a.n.resolve({resultType:i.t.Success})},e}(),c=Object(r.r)("ItemRedeemer",s,{ticketRedeemer:o.me.async.optional})},7062:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(32),r=n(118),o=n(2206),s=n(2214),c=n(110),d=n(3691),l=n(357),u=n(182),f=n(2351),p=n(2910),m=n(1316),_=n(49),h=n(4654),b=n(679),g=function(e){function t(t){var n=e.call(this,t)||this,a=t.overrideItem,i=t.scenarioId,o=t.defaultRecipients;return n._itemRedeemer=n.resources.consume(h.e),n._itemBeingShared=n.resources.consume(t.focusItemResourceKey),n._selectionHelper=new(n.child(s.e))({overrideItem:a?n.createObservable(t.overrideItem):null,allowMultiSelect:!1,canFallback:!0}),n._sharingDataSourceHelper=new(n.managed(d.e)),n._urlDataSource=n.resources.consume(r.he),n._itemCommandHelper=n.resources.consume(f.t),n._itemUrlHelper=n.resources.consume(l.s),n._pageContext=n.resources.consume(_.p),n._scenarioId=i,n._defaultRecipients=o,n.name="ShowShareAction",n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var t=this._selectionHelper.firstItem();if(!t)return!1;if(!this._itemCommandHelper.isCommandSupported(t,p.a))return!1;var n=this._itemUrlHelper.getItemUrlParts(t.key);if(n&&n.siteRelation===l.t.crossSite&&!this._pageContext.isNoScriptEnabled)return!1;var a=t.mruState,i=!a||a.canBeShared,r=!!this._sharingDataSourceHelper.getParentListId(t),o=t.properties&&(!!t.properties.ID||!!t.properties.uniqueId);return!!this._itemBeingShared()||e.prototype.onIsAvailable.call(this)&&!this._urlDataSource.isRecycleBin(t.queryType)&&!t.isRootFolder&&!t.list&&i&&r&&o&&!(t.lifeCycleStatus&&t.lifeCycleStatus.isExternal)},t.prototype.onExecute=function(e,t){var n=this;this._itemBeingShared.peek()&&this._itemBeingShared(void 0);var a=this._selectionHelper.firstItem.peek();return this._itemRedeemer.redeemItems([a],this).then(function(){return t.data.extraData||(t.data.extraData={}),u.e(t.data.extraData,{uniqueId:a.properties?a.properties.uniqueId:void 0,Host:Object(b.e)()}),n._itemBeingShared({items:[a],scenarioId:n._scenarioId,defaultRecipients:n._defaultRecipients}),c.n.wrap({resultType:i.t.Success})},function(e){return c.n.reject(e)})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(m.e,{item:this._selectionHelper.firstItem})},t}(o.e);t.default=g}}]);