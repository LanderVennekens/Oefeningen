(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[7],{2306:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.notConfigured=0]="notConfigured",e[e.visible=1]="visible",e[e.notVisible=2]="notVisible"}(a||(a={}))},2375:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(6),i=n(925),r=n(2306),o=new a.t({name:"".concat("FirstRunExperienceStatus.key",".FirstRunExperienceStatus"),factory:{dependencies:{},create:function(e){return{instance:new i.e(r.e.notConfigured)}}}})},2744:function(e,t,n){"use strict";n.d(t,"y",function(){return r}),n.d(t,"v",function(){return o}),n.d(t,"p",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"o",function(){return d}),n.d(t,"m",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"a",function(){return f}),n.d(t,"n",function(){return p}),n.d(t,"i",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"r",function(){return h}),n.d(t,"s",function(){return b}),n.d(t,"l",function(){return g}),n.d(t,"u",function(){return v}),n.d(t,"f",function(){return y}),n.d(t,"d",function(){return S}),n.d(t,"g",function(){return D}),n.d(t,"b",function(){return I}),n.d(t,"_",function(){return x}),n.d(t,"h",function(){return C}),n.d(t,"I",function(){return O}),n.d(t,"S",function(){return w}),n.d(t,"D",function(){return E});var a=n(222),i=n(5),r=a.n.isFeatureEnabled,o={ODB:817,ODC:!0,OneDrive:!0},s={ODB:60124,ODC:"UseMsPdfViewer",OneDrive:!1,Fallback:!1},c={ODB:60358},d={ODB:1655,ODC:!1,OneDrive:!1,Fallback:!1},l={ECS:1071224},u={ECS:1082725},f={ECS:1111474},p={ECS:1116309},m={ECS:1125492},_={ECS:1126891},h={ODB:1614,ODC:!1,OneDrive:!1,Fallback:!1},b={ODB:1063,ODC:!1,OneDrive:!1,Fallback:!1},g={ODB:1513,ODC:!1,OneDrive:!1,Fallback:!1},v={ODB:60165},y={ODB:60192},S={ODB:61066},D={ODB:1355,ODC:!1,OneDrive:!1,Fallback:!1},I={ODB:61094,ODC:!1,OneDrive:!1,Fallback:!1},x={ODB:!i.e.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),ODC:!0},C={ODB:!0,OneDrive:!0},O={ODB:61113},w={ODB:61125},E={ODB:61217}},3050:function(e,t,n){"use strict";n.d(t,"e",function(){return S}),n.d(t,"t",function(){return D});var a=n(0),i=n(178),r=n(59),o=n(188),s=n(226),c=n(687),d=n(3159),l=n(175),u=n(2744),f=n(3219),p=n(87),m=n(46),_=n(949),h=n(3188),b=n(3221),g=n(3220),v=".pdf",y=["ODBLightSpeedWebPack"],S=function(){function e(e,t){this._enablePdf=Object(u.y)(u.v),this._enableMsPdfviewer=Object(u.y)(u.p),this._enableEmbedMsPdfviewer=Object(u.y)(u.o),this._enableEditPdf=Object(u.y)(u.r),this._enableExtractPdf=Object(u.y)(u.l),this._enablePreviewTif=Object(u.y)(u._),this._enableHTML=Object(u.y)(u.h)&&(Object(f.e)()||t.platformDetection.isEdge),this._urlDataSource=t.urlDataSource,this._pdfDataSource=t.pdfDataSource,this._navigation=t.navigation,this._viewParams=this._navigation.viewParams,this._pageContext=t.pageContext,this._embedOptions=t.embedOptions}return e.isWasmSupported=function(){if(void 0===e._isWasmSupported){var t=!1;try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var n=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));n instanceof WebAssembly.Module&&(t=new WebAssembly.Instance(n)instanceof WebAssembly.Instance)}}catch(e){}e._isWasmSupported=t}return e._isWasmSupported},e.prototype.isNotEmbed=function(){return this._urlDataSource.getPageType(this._viewParams)!==l.e.Embed},e.prototype.isSupportedFileType=function(e){var t=this._extension(e);return this._enablePdf&&(t===v||".ai"===t||!!e.pdfConversion)&&(this._enablePreviewTif||".tif"!==t&&".tiff"!==t)},e.prototype.isMsPdfViewerSupported=function(e){var t;if(!e)return!1;var n=this._enableMsPdfviewer&&(this.isNotEmbed()||this._enableEmbedMsPdfviewer),a=this._isHostAppTeams()&&Object(g.e)(u.m.ECS),i=!Object(b.a)()&&!Object(g.t)(u.e.ECS)&&!this.isNotEmbed()&&((null===(t=this._embedOptions)||void 0===t?void 0:t.useMsPdf)||!1);return(n||a||i)&&this._isMsPdfViewerSupported(e)},e.prototype.isMsPdfViewerAvailable=function(e){return this.isSupportedFileType(e)&&this._isEnabledInOneUp(e)&&this.isMsPdfViewerSupported(e.size)},e.prototype.isPdfEditAvailable=function(e){return this.isMsPdfViewerAvailable(e)&&(this._enableEditPdf||!this.isNotEmbed()&&!Object(b.e)()&&!Object(g.t)(u.a.ECS))&&this._extension(e)===v},e.prototype.isPdfExtractAvailable=function(e){return this.hasSyntexLicense()&&this.isMsPdfViewerAvailable(e)&&this.isNotEmbed()&&this._enableExtractPdf},e.prototype.isPdfExtractable=function(){return this.hasSyntexLicense()&&this._enableExtractPdf},e.prototype.isPdfEditable=function(e){var t;return e.itemStatus!==i.t.ConditionalAccessViewOnly&&e.itemStatus!==i.t.ConditionalAccessBlocked&&(null===(t=this._pdfDataSource)||void 0===t?void 0:t.canSave({item:e}))},e.prototype.getWorkerManifestName=function(){var e,t=(null===(e=window._spModuleLink)||void 0===e?void 0:e.manifestName)||"";return Object(u.y)(u.c)&&-1!==y.indexOf(t)?"odbmspdfwebworker":"mspdfwebworker"},e.prototype.getEmbedOptions=function(){return this._embedOptions},e.prototype.hasSyntexLicense=function(){var e,t;return(null===(e=this._pageContext)||void 0===e?void 0:e.canUserUseSyntex)||Object(b.r)()&&(null===(t=this._pageContext)||void 0===t?void 0:t.isUserSyntexV2Licensed)||!1},e.prototype._isHostAppTeams=function(){if(this.isNotEmbed())return!1;var e=this._getClientId();return!!e&&-1!==["MicrosoftTeams","Microsoft Teams","Microsoft Teams Web Client","Teams Service","Teams Client App","Teams Additional Client App","Teams App"].indexOf(e)},e.prototype._isEnabledInOneUp=function(e){return!(e.officeBundle||e.wopiFrameUrl||this._enableHTML&&e.htmlConversion)},e.prototype._isMsPdfViewerSupported=function(t){if(!t)return!1;var n=t<(performance.memory?performance.memory.jsHeapSizeLimit-performance.memory.totalJSHeapSize:268435456)/4;return e.isWasmSupported()&&n},e.prototype._extension=function(e){return e&&e.extension&&e.extension.toLowerCase()||""},e.prototype._getClientId=function(){var e,t=(null===(e=this._pageContext)||void 0===e?void 0:e.authToken)||"",n=Object(c.a)(t);return n&&n.app_displayname||this._getClientIdFromQSP()},e.prototype._getClientIdFromQSP=function(){var e,t=window,n=Object(s.e)((t.location.search||"").slice(1)),i=Object(s.e)((t.location.hash||"").slice(1)),r=(null===(e=t.PageContext)||void 0===e?void 0:e.scenarioContext.embed)||{};return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},n),i),r).client_id},e.dependencies={},e}(),D=Object(r.r)("PdfViewerHelper",S,{platformDetection:o.e,urlDataSource:_.e,navigation:p.e,pdfDataSource:h.e,pageContext:m.e.optional,embedOptions:d.e.optional})},3053:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(0),i=n(33),r=n(2182),o=n(59),s=n(131),c=n(72),d=n(87),l=n(373),u=n(2375),f=n(2306),p=n(190),m="CoachmarkTearDropSeen",_={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:i.Off,isCoachmark:!0},h=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._dataStore=new s.e("CoachmarkProvider",c.e.session),a._currentCampaign=a.createObservable(_),a._isVisible=a.createObservable(!1),a._navigation=n.navigation,a._firstRunExperienceStatus=n.firstRunExperienceStatus,a._currentTeachingBubble=a.createObservable({campaign:a._currentCampaign,isVisible:a._isVisible}),a._navigation.viewParams.resetAllBubbles&&a._dataStore.remove(m);var i=a.resources.consume(p.e);return a._teachingBubbleProviderPromise=i.waitForPLT().then(function(){return a.resources.consume(l.I)}),a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!1,configurable:!0}),t.prototype.hideCampaign=function(){this._isVisible(!1),this._currentCampaign(_)},t.prototype.setCampaign=function(e){var t=this;if(!e)return this._currentCampaign(_),void this._isVisible(!1);if(this._firstRunExperienceStatus.get()!==f.e.visible){var n="".concat(e.name).concat(m);this._dataStore.getValue(m)||this._teachingBubbleProviderPromise.then(function(a){a&&a.shouldBubbleBeAdded(e,!1).then(function(a){a&&(t._currentCampaign(e),t._isVisible(!0),t._dataStore.setValue(n,!0))})})}},t.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.n.dependencies),{navigation:d.e,firstRunExperienceStatus:u.e}),t}(r.n),b=Object(o.r)("CoachmarkProvider",h)},3159:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(6).t)("pdfViewerEmbedOptions")},3163:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"n",function(){return l});var a=n(0),i=n(32),r={};function o(e){return r[e]}function s(e,t){r[e]=t}function c(e){var t=o(e);if(t&&(t.end({resultType:i.t.Failure}),t=void 0),!t){var n={name:e};s(e,t=new i.e(n))}return t}function d(e){u(e,i.t.Success)}function l(e,t){u(e,i.t.Failure,t)}function u(e,t,n){var i=o(e);if(i){var r={resultType:t};n&&(r=Object(a.__assign)(Object(a.__assign)({},r),{resultCode:n.name||"Unknown",error:n.message||"Unknown",extraData:{errorStackTrace:n.stack}})),i.end(r),s(e,void 0)}}},3188:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(59),r=n(64),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.canSaveAsOriginal=function(e){var t=e.item;return!!t&&r.e.hasItemPermission(t,r.e.insertListItems)&&r.e.hasItemPermission(t,r.e.editListItems)},t.dependencies={},t}(function(){function e(){}return e.prototype.canSave=function(e){return this.canSaveAsOriginal(e)},e}()),s=Object(i.r)("PdfDataSource",o)},3218:function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l});var a=n(59),i=n(2182),r=n(356),o=n(3261),s=n(17),c=n(3050),d=function(){function e(e,t){var n=t.observablesFactoryType,a=t.viewParams,i=new n;this._corePdfViewerHelper=t.corePdfViewerHelper;var r=this.getEmbedOptions(),c=(null==r?void 0:r.allowEdit)&&(null==r?void 0:r.openInEditMode),d="ZXNpZ24"===a()[s.n.navParamKey]?o.e.Esign:c?o.e.Edit:o.e.View;this.state={isOpened:i.create(!1),currentMode:i.create(d),filePickerMode:i.create("close")}}return e.isWasmSupported=function(){return c.e.isWasmSupported()},e.prototype.isMsPdfViewerAvailable=function(e){return this._corePdfViewerHelper.isMsPdfViewerAvailable(this._convertItem(e))},e.prototype.isMsPdfViewerSupported=function(e){return this._corePdfViewerHelper.isMsPdfViewerSupported(e)},e.prototype.isNotEmbed=function(){return this._corePdfViewerHelper.isNotEmbed()},e.prototype.isPdfEditAvailable=function(e){return this._corePdfViewerHelper.isPdfEditAvailable(this._convertItem(e))},e.prototype.isPdfEditable=function(e){return this._corePdfViewerHelper.isPdfEditable(this._convertItem(e))},e.prototype.isSupportedFileType=function(e){return this._corePdfViewerHelper.isSupportedFileType(this._convertItem(e))},e.prototype.getWorkerManifestName=function(){return this._corePdfViewerHelper.getWorkerManifestName()},e.prototype.getEmbedOptions=function(){return this._corePdfViewerHelper.getEmbedOptions()},e.prototype.isPdfExtractAvailable=function(e){return this._corePdfViewerHelper.isPdfExtractAvailable(this._convertItem(e))},e.prototype.isPdfExtractable=function(){return this._corePdfViewerHelper.isPdfExtractable()},e.prototype.hasSyntexLicense=function(){return this._corePdfViewerHelper.hasSyntexLicense()},e.prototype._convertItem=function(e){return e},e.dependencies={observablesFactoryType:i.i,viewParams:r.P,corePdfViewerHelper:c.t},e}(),l=Object(a.r)("PdfViewerHelper",d)},3219:function(e,t,n){"use strict";var a;function i(){return"boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a}n.d(t,"e",function(){return i})},3220:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i});var a=function(e){var t,n,a,i;if(!e)return!1;var r=(null===(t=window.Flight)||void 0===t?void 0:t.ecsConfig)&&JSON.parse(null===(n=window.Flight)||void 0===n?void 0:n.ecsConfig),o=null===(i=null===(a=null==r?void 0:r.RolloutContext)||void 0===a?void 0:a.settings)||void 0===i?void 0:i.ODSPMicroservices_ODWeb;return o&&!0===o[e]},i=function(e){return a(e)}},3221:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"r",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"i",function(){return d});var a=n(5),i=function(){return a.e.isActivated("c3dc126d-70db-4dc6-9ad6-3ce6d59dfaca")},r=function(){return!a.e.isActivated("acc3d562-8099-40b9-ad90-f199e8fcec91","6/15/2023","Syntex V2 License check")},o=function(){return a.e.isActivated("f644d6f3-bfb2-4b67-9ea4-f2bbd98431b0","07/17/2023","Enable editing for mspdf in embed scenarios")},s=function(){return a.e.isActivated("106d45a3-37c3-42cd-95a6-8a04645f8a7b","08/07/2023","Enable host saving for embedded scenarios")},c=function(){return a.e.isActivated("ed408543-0a69-47e8-a898-31bf63f74ce6","08/28/2023","Enable sending PDF related notifications to host for embedded scenarios")},d=function(){return a.e.isActivated("7734ec9d-6955-4473-9ea5-1c21baf2af07","08/31/2023","Fix page content with some Chinese characters cannot be rendered")}},3261:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.View=0]="View",e[e.Edit=1]="Edit",e[e.Extract=2]="Extract",e[e.Esign=3]="Esign"}(a||(a={}))},3392:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"n",function(){return o});var a=function(e,t,n,a){return i(e,t,n)+(a+"\r\n")},i=function(e,t,n){var a="--"+e+"\r\n";return(a+="Content-ID: "+t+"\r\n")+"Content-Type: "+n+"\r\n\r\n"},r=function(e,t,n){var a="--"+e+"\r\n";return(a+="Content-Type: "+t+"\r\n")+"Content-Transfer-Encoding: "+n+"\r\n\r\n"},o=function(e,t,n,a,i){var r=n+" "+a+" HTTP/1.1\r\n";return r+="Content-Type: "+e+"\r\n",r+="Accept: "+t+"\r\n",i&&(r+="Content-Length: "+i+"\r\n\r\n"),r}},3583:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return c});var a,i,r=n(0),o=n(86),s=n(32);!function(e){e.AddAnnotation="OneUpUniversalAnnotation.AddAnnotation",e.DeleteAnnotation="OneUpUniversalAnnotation.DeleteAnnotation",e.Enter="OneUpUniversalAnnotation.EnterUniversalAnnotation",e.Exit="OneUpUniversalAnnotation.ExitUniversalAnnotation",e.Undo="OneUpUniversalAnnotation.UndoOperationOnAnnotations",e.Redo="OneUpUniversalAnnotation.RedoOperationOnAnnotations"}(a||(a={})),function(e){e.PullAnnotation="OneUpUniversalAnnotation.PullAnnotation",e.PushAnnotation="OneUpUniversalAnnotation.PushAnnotation",e.PreloadAnnotation="OneUpUniversalAnnotation.PreloadAnnotation"}(i||(i={}));var c=function(){function e(){}return e.logEngagement=function(t){o.e.logData({name:t,scenario:"1up Universal Annotation with msPdf Viewer",docId:e.itemId})},e.initQosEvent=function(t){var n=e._getEventQos(t);if(n&&(n.end({resultType:s.t.Failure,resultCode:e._prevEventNotEndFailure.name,error:e._prevEventNotEndFailure.message}),n=void 0),!n){var a={name:t};n=new s.e(a),e._setEventQos(t,n)}},e.logQosSuccess=function(t){e._internalLogQosEvent(t,s.t.Success)},e.logQosUnexpectedFailure=function(t,n){e._internalLogQosEvent(t,s.t.Failure,n)},e.logQosExpectedFailure=function(t,n){e._internalLogQosEvent(t,s.t.ExpectedFailure,n)},e._getEventQos=function(t){return e._eventQosCollection[t]},e._setEventQos=function(t,n){e._eventQosCollection[t]=n},e._resetEventQos=function(t){e._eventQosCollection[t]=void 0},e._internalLogQosEvent=function(t,n,a){var i=e._getEventQos(t);if(i){var o={resultType:n};a&&(o=Object(r.__assign)(Object(r.__assign)({},o),{resultCode:a.name||"Unknown",error:a.message||"Unknown",extraData:{errorStackTrace:a.stack,itemId:e.itemId}})),i.end(o),e._resetEventQos(t)}},e.itemId=void 0,e._eventQosCollection={},e._prevEventNotEndFailure={name:"previous qos event does not end",message:"previous qos event does not end while the new qos event of the same time is triggered. Now ends the previous event unexpectedly"},e}()},3605:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(2182),i=new(n(6).t)({name:"".concat("UniversalAnnotationStateKey",".universalAnnotationState"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:{isUniversalAnnotationActive:t.create(!1),hasPreloadSucceeded:t.create(!0)},disposable:t}}}})},3959:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a,i,r=n(0),o=n(248),s=n(3392),c=n(147),d=n(59),l=n(1365),u=n(46),f=n(2744);!function(e){e.Annotation="universalannotations",e.Layer="annotationlayers",e.Batch="$batch"}(a||(a={})),function(e){e.MultipartMixedBoundary="multipart/mixed;boundary=",e.JSON="application/json",e.HTTP="application/http"}(i||(i={}));var p=function(){function e(e,t){this._token=null,this._layerPath="";var n=t.vroomDataRequestor,a=t.pageContext;this._dataRequestor=n,this._pageContext=a}return e.prototype.update=function(e,t,n){this._getSharePointToken=e,this._basePath="/drives/".concat(n,"/items/").concat(t),this._layerPath="".concat(this._basePath,"/").concat(a.Layer)},e.prototype.createLayer=function(e){var t=e.title,n=e.mainFileVersion,a=void 0===n?"1.0":n,i=e.layerId,r=this._layerPath;return this._sendRequest({path:r,requestType:"POST",data:{title:t,mainFileVersion:a,id:i}})},e.prototype.deleteLayer=function(e){var t=e.layerId,n="".concat(this._layerPath,"/").concat(t);return this._sendRequest({path:n,requestType:"DELETE"})},e.prototype.getLayers=function(){var e=this._layerPath;return this._sendRequest({path:e,requestType:"GET"})},e.prototype.createAnnotation=function(e){var t=e.annotationId,n=e.layerId,a=e.content,i=e.partitionId,r=e.anchor,o=e.contentType,s=this._getAnnotationUrl(n);return this._sendRequest({path:s,requestType:"POST",data:{id:t,content:a,partitionId:i,anchor:r,contentType:o}})},e.prototype.getAnnotations=function(e){var t=e.layerId,n=e.partitionId,a=this._getAnnotationUrl(t);return n&&(a+="?partitionId=".concat(n)),this._sendRequest({path:a,requestType:"GET"})},e.prototype.deleteAnnotation=function(e){var t=e.layerId,n=e.partitionId,a=e.annotationId,i="".concat(this._getAnnotationUrl(t),"/").concat(a,"?partitionId=").concat(n);return this._sendRequest({path:i,requestType:"DELETE"})},e.prototype.batchCreateAnnotations=function(e){var t=e.payload;return Object(r.__awaiter)(this,void 0,void 0,function(){var e,n,o=this;return Object(r.__generator)(this,function(s){return e="batch_"+c.e.generate(),n=this._createBatchBody(e,t.map(function(e){var t=e.id,n=e.layerId,i=e.annotationId,s=Object(r.__rest)(e,["id","layerId","annotationId"]);return{path:"".concat(o._basePath,"/AnnotationLayers('").concat(n,"')/").concat(a.Annotation),requestType:"POST",id:t,data:Object(r.__assign)({id:i},s)}})),[2,this._sendRequest({path:"/".concat(a.Batch),requestType:"POST",headers:{"Content-Type":i.MultipartMixedBoundary+e},data:n})]})})},e.prototype.batchDeleteAnnotations=function(e){var t=e.payload;return Object(r.__awaiter)(this,void 0,void 0,function(){var e,n,o=this;return Object(r.__generator)(this,function(r){return e="batch_"+c.e.generate(),n=this._createBatchBody(e,t.map(function(e){var t=e.id,n=e.annotationId,a=e.layerId,i=e.partitionId;return{path:"".concat(o._getAnnotationUrl(a),"/").concat(n,"?partitionId=").concat(i),requestType:"DELETE",id:t}})),[2,this._sendRequest({path:"/".concat(a.Batch),requestType:"POST",headers:{"Content-Type":i.MultipartMixedBoundary+e},data:n})]})})},Object.defineProperty(e.prototype,"hasLicense",{get:function(){return Object(f.y)(f.b)?Boolean(this._pageContext.canUserUseSyntex)||Boolean(this._pageContext.isUserSyntexV2Licensed):Boolean(this._pageContext.canUserUseSyntex)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_server",{get:function(){return Object(o.s)(this._pageContext)},enumerable:!1,configurable:!0}),e.prototype._needRefreshToken=function(){return!this._token||!this._token.tokenExpiry||Date.now()>=this._token.tokenExpiry},e.prototype._getToken=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return this._needRefreshToken()&&this._getSharePointToken?[4,this._getSharePointToken(this._server)]:[3,2];case 1:e=t.sent(),this._token=e,t.label=2;case 2:return[2,this._token||void 0]}})})},e.prototype._getAnnotationUrl=function(e){return"".concat(this._layerPath,"/").concat(e,"/").concat(a.Annotation)},e.prototype._createBatchBody=function(e,t){var n,a="\r\n",r="changeset_".concat(c.e.generate()),o=Object(s.a)(e,"".concat(i.MultipartMixedBoundary,'"').concat(r,'"'),"binary")+t.map(function(e){return t=e,n="--"+r+a,n+="Content-Type: "+i.HTTP+a,n+="Content-Transfer-Encoding: binary\r\n",n+="Content-ID: "+t.id+a,n+=a,n+=Object(s.n)(i.JSON,"".concat(i.JSON,";odata=verbose"),t.requestType,t.path),n+=a,t.data&&(n+=JSON.stringify(t.data)+a,n+=a),n;var t,n}).join("")+(n="--"+r+"--"+a,n+=a,n+="--"+e+"--"+a);return new Blob([o])},e.prototype._sendRequest=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,o,s;return Object(r.__generator)(this,function(c){switch(c.label){case 0:return[4,this._getToken()];case 1:return t=c.sent(),n=e.data,a=e.path,i=e.requestType,o=e.headers,s=n?n instanceof Blob?n:JSON.stringify(n):void 0,[2,this._dataRequestor.send({path:a,endpoint:"".concat(this._server,"/_api/v2.1"),headers:Object(r.__assign)({Scenario:"Syntex_UniversalAnnotaion"},o),requestType:i,accessToken:t,apiName:"UniversalAnnotationAPI",apiVersion:"v2.1",postData:s,expectedErrorCodes:{resourceModified:!0}})]}})})},e.dependencies={vroomDataRequestor:l.e,pageContext:u.e},e}(),m=Object(d.r)("UniversalAnnotationDataSource",p)},7035:function(e,t,n){"use strict";n.r(t),n.d(t,"ActivateUniversalAnnotationAction",function(){return b});var a=n(0),i=n(2206),r=n(110),o=n(32),s=n(3163),c=n(3605),d=n(3774),l=n(3583),u=n(356),f=n(3218),p=n(3959),m=n(3053),_=n(933),h=n(33),b=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="ActivateUniversalAnnotation",a._universalAnnotationState=a.resources.consume(c.e),a._currentSlideItem=a.resources.consume(u.m),a._pdfViewerHelper=a.resources.consume(f.t),a._universalAnnotationDataSource=a.resources.consume(p.e),a._isEsignPanelActivated=a.resources.consume(d.resourceKey),Object(h.isFeatureEnabled)(h.UseMsPdfViewer)&&Object(h.isFeatureEnabled)(h.UseUniversalAnnotation)&&Object(h.isFeatureEnabled)(h.ERBugFixesEnabledForUniversalAnnotation)&&(a._coachmarkProvider=a.resources.consume(m.e.optional)),a}return Object(a.__extends)(t,e),t.prototype.onExecute=function(){var e,t=!this._universalAnnotationState.isUniversalAnnotationActive.peek();return t?(s.e("LaunchUniversalAnnotation"),l.n.logEngagement(l.e.Enter)):l.n.logEngagement(l.e.Exit),this._universalAnnotationState.isUniversalAnnotationActive(t),Object(h.isFeatureEnabled)(h.ERBugFixesEnabledForUniversalAnnotation)&&(null===(e=this._coachmarkProvider)||void 0===e?void 0:e.currentCampaign())===_.USE_UNIVERSAL_ANNOTATION&&this._coachmarkProvider.hideCampaign(),r.n.wrap({resultType:o.t.Success})},t.prototype.onIsAvailable=function(){if(!this._currentSlideItem)return!1;var e=this._currentSlideItem();return!!e&&!this._isEsignPanelActivated()&&this._universalAnnotationState.hasPreloadSucceeded()&&this._universalAnnotationDataSource.hasLicense&&this._pdfViewerHelper.isNotEmbed()&&this._pdfViewerHelper.isMsPdfViewerAvailable(e())},t.prototype.onIsToggled=function(){return this._universalAnnotationState.isUniversalAnnotationActive()},t}(i.e);t.default=b}}]);