(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[766],{2545:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"a",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"n",function(){return u}),n.d(t,"l",function(){return f}),n.d(t,"s",function(){return p}),n.d(t,"u",function(){return m}),n.d(t,"c",function(){return _}),n.d(t,"d",function(){return h}),n.d(t,"o",function(){return b}),n.d(t,"t",function(){return g}),n.d(t,"i",function(){return v});var a=n(370),i=n(9),r=n(189),o=n(622),s=new a.e("itemSetTypeFilterHandler");function c(e){return{key:s.serializeNext(),filter:e}}var d=c(function(e,t){return!!e.demandItemFacet(i.h,t.itemKey)}),l=c(function(e,t){return!d.filter(e,t)}),u=c(function(e,t){var n=e.demandItemFacet(i.m,t.itemKey),a=e.demandItemFacet(i.h,t.itemKey);return!!n&&!a}),f=(c(function(e,t){var n=e.demandItemFacet(i.m,t.itemKey),a=e.demandItemFacet(i.h,t.itemKey);return!!n&&!!a}),c(function(e,t){var n,a=null===(n=e.demandItemFacet(i.m,t.itemKey))||void 0===n?void 0:n.extension;return!(!a||"photo"!==Object(o.e)(a))})),p=c(function(e,t){return!f.filter(e,t)}),m=c(function(e,t){var n,a=null===(n=e.demandItemFacet(i.m,t.itemKey))||void 0===n?void 0:n.extension;return!(!a||"video"!==Object(o.e)(a))}),_=c(function(e,t){return!m.filter(e,t)}),h=c(function(e,t){return!!e.demandItemFacet(r.i,t.itemKey)}),b=c(function(e,t){return!e.demandItemFacet(r.i,t.itemKey)}),g=c(function(e,t){var n,a=null===(n=e.demandItemFacet(i.m,t.itemKey))||void 0===n?void 0:n.extension;return!(!a||"audio"!==Object(o.e)(a))}),v=c(function(e,t){return!g.filter(e,t)})},3708:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=!n(5).e.isActivated("412301EB-A806-49EF-837F-4164D0D5DB49","03/27/2023","Resolve fav signal from cache")},3807:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(1),i=n(512),r=new a.e("followed"),o=new i.e("followedItem")},4833:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(9);function r(e,t,n){var r;e.resolveItems({items:(r={},r[t]=Object(a.__assign)({},i.S.pack(n)),r)})}},5165:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(9),i=n(2545),r=n(68),o=n(622),s=n(1611),c=n(1441);function d(e,t){var n,d=t.itemKey,l=t.isItemMountPoint,u=e.demandItemFacet(a.b,d);if(e.demandItemFacet(a.S,null==u?void 0:u.itemKey))return!0;var f=Object(r.e)(e,{enableFavoritesV2:c.e}).enableFavoritesV2,p=null===(n=e.demandItemFacet(a.m,d))||void 0===n?void 0:n.extension,m=p&&Object(o.e)(p),_=i.d.filter(e,{itemKey:d}),h=i.a.filter(e,{itemKey:d});return Object(s.e)({fileIconType:h?"folder":m||"",extension:p,isItemOneNote:_,isFavoritesV2Enabled:(null==f?void 0:f())||!1,isItemMountPoint:l})}},5166:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(1388),i=n(694),r=n(298),o=n(47),s=n(1480),c=n(4833);function d(e,t){var n,d,l,u=t.isFavorited,f=t.id,p=t.spItem,m=void 0===p?{}:p,_=t.driveItem,h=void 0===_?{}:_,b=t.sharesItemKey,g=s.e.serialize({id:f});Object(c.e)(e,g,u);var v=h.webAbsoluteUrl,y=h.itemId,S=h.driveId;if(v&&S&&y){var D=new o.e(v).authority,I="".concat(D,"/_api/v2.0"),x=a.e.serialize({driveItem:{endpoint:I,driveId:S,itemId:y}});e.mapKeys({mappings:(n={},n[x]=g,n)})}b&&e.mapKeys({mappings:(d={},d[b]=g,d)});var C=m.itemUrl;if(C){var O=Object(r.e)(C),w=i.e.serialize({spItemFullUrl:{itemFullUrl:O}});e.mapKeys({mappings:(l={},l[w]=g,l)})}return g}},7382:function(e,t,n){"use strict";n.r(t),n.d(t,"spFavoritesAddon",function(){return C});var a=n(16),i=n(278),r=n(9),o=n(112),s=n(246),c=n(0),d=n(23),l=n(1201),u=n(1572),f=Object(a.n)()(function(e){var t=this;return function(e){return Object(c.__awaiter)(t,void 0,void 0,function(){var t;return Object(c.__generator)(this,function(n){switch(n.label){case 0:return t=u.e.serialize({}),[4,e(Object(l.e)(function(e){return e.demandItemFacet(d.e,t)}))];case 1:return n.sent(),[2]}})})}}),p=n(694),m=n(18),_=n(844),h=n(3807),b=n(5165),g=n(5),v=n(3),y=n(45),S=n(339),D=!g.e.isActivated("F01DE29D-B569-499E-83F8-AF66263E0852","03/24/2023","Do not show favorite command until data resolves");function I(e,t){var n=t.itemKeys,a=u.e.serialize({}),i=!!e.demandItemFacet(d.e,a);if(D&&!i)return{isAvailable:!1};if(!n.every(function(t){var n=!!e.demandItemFacet(v.ot,t);return Object(b.e)(e,{itemKey:t,isItemMountPoint:n})}))return{isAvailable:!1};var r=n[0],o=e.demandItemFacet(y.e,r),s=o&&S.e.serialize(o),c=e.demandItemFacet(v.Qe,s);return{isAvailable:!!(null==c?void 0:c.isDocumentLibrary)}}var x=Object(a.t)(function(){return function(e){e(Object(m.t)(y.e,_.e)(I)),e(Object(i.t)(p.t,h.e)(Object(a.a)(function(){return Object(c.__awaiter)(void 0,void 0,void 0,function(){return Object(c.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([406],7013)];case 1:return[2,e.sent().spItemFollowItemOperationHandler]}})})})))}}),C=Object(a.t)(function(){return function(e){e(Object(o.t)({keyFacet:p.t,facets:[r.S]})),e(Object(i.t)(p.t,s.e)(f)),e(x)}})},7421:function(e,t,n){"use strict";n.r(t),n.d(t,"substrateFavoritesAddon",function(){return C});var a=n(16),i=n(278),r=n(9),o=n(23),s=n(44),c=n(112),d=n(246),l=n(0),u=n(37),f=n(116),p=n(263),m=n(3708),_=n(77),h=n(1480),b=n(1656),g=n(5166),v=n(4833),y=n(1610),S=Object(a.i)()(function e(t){var n=this,a=t.itemKey;return function(t){return Object(l.__awaiter)(n,void 0,void 0,function(){var n,i,r,c,d,S,D,I,x,C,O;return Object(l.__generator)(this,function(w){switch(w.label){case 0:if(n=t(Object(f.e)({isFavoritesEnabled:u.w,favoritesProvider:b.e})),i=n.isFavoritesEnabled,r=n.favoritesProvider,!(null==i?void 0:i()))return[2];if(!(null==r?void 0:r.getFavoritedItems))throw new _.e({code:"NoEdgeworthProvider"});if(c=new Set,d=!1,!m.e)return[3,4];w.label=1;case 1:return w.trys.push([1,3,,4]),[4,r.getFavoritedItems({cachingStrategy:p.e.onlyCache,cacheTimeoutTime:0,ignoreDirtyCache:!0})];case 2:return(S=w.sent())&&(D=new s.e({publisher:e}),S.forEach(function(e){var t,n,a=Object(g.e)(D,{isFavorited:!0,id:e.file.Id,spItem:{itemUrl:Object(y.e)(e)},driveItem:{webAbsoluteUrl:e.file.SharePointItem.SitePath,driveId:null===(t=e.file.OneDriveInfo)||void 0===t?void 0:t.DriveId,itemId:null===(n=e.file.OneDriveInfo)||void 0===n?void 0:n.ItemId}});c.add(a)}),D.resolveItems({items:(C={},C[a]=Object(l.__assign)({},o.e.pack({itemKeys:Array.from(c)})),C)}),t(D.execute())),[3,4];case 3:return w.sent(),d=!0,[3,4];case 4:I=new s.e({publisher:e}),x=[],w.label=5;case 5:return w.trys.push([5,7,,8]),[4,r.getFavoritedItems({cachingStrategy:p.e.bypassCache,cacheTimeoutTime:0})];case 6:return(w.sent()||[]).forEach(function(e){var t,n,a=h.e.serialize({id:e.file.Id});x.push(a),c.has(a)?c.delete(a):(d=!0,Object(g.e)(I,{isFavorited:!0,id:e.file.Id,spItem:{itemUrl:Object(y.e)(e)},driveItem:{webAbsoluteUrl:e.file.SharePointItem.SitePath,driveId:null===(t=e.file.OneDriveInfo)||void 0===t?void 0:t.DriveId,itemId:null===(n=e.file.OneDriveInfo)||void 0===n?void 0:n.ItemId}}))}),c.size>0&&(d=!0,c.forEach(function(e){Object(v.e)(I,e,void 0)})),[3,8];case 7:return w.sent(),d=!0,[3,8];case 8:return d&&I.resolveItems({items:(O={},O[a]=Object(l.__assign)({},o.e.pack({itemKeys:x})),O)}),t(I.execute()),[2]}})})}}),D=n(1201),I=n(405),x=Object(a.n)()(function(e){var t=this;return function(e){return Object(l.__awaiter)(t,void 0,void 0,function(){var t;return Object(l.__generator)(this,function(n){switch(n.label){case 0:return t=I.e.serialize({}),[4,e(Object(D.e)(function(e){return e.demandItemFacet(o.e,t)}))];case 1:return n.sent(),[2]}})})}}),C=Object(a.t)(function(){return function(e){e(new s.e({publisher:C}).execute()),e(Object(c.t)({keyFacet:h.e,facets:[r.S]})),e(Object(i.t)(h.e,d.e)(x)),e(Object(c.t)({keyFacet:I.e,facets:[o.e]})),e(Object(i.t)(I.e,d.e)(S))}})}}]);