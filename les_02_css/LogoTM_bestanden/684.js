(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[684,345],{1969:function(e,t,n){"use strict";n.d(t,"e",function(){return y}),n.d(t,"t",function(){return S}),n.d(t,"n",function(){return D}),n.d(t,"i",function(){return I}),n.d(t,"a",function(){return x}),n.d(t,"o",function(){return C}),n.d(t,"r",function(){return O});var a=n(0),i=n(245),r=n(1881),o=n(2341),s=n(920),c=n(530),d=n(416),l=n(116),u=n(1329),f=n(1324),p=n(91),m=n(110),_=n(917),h=n(590),b=n(229),g=n(807),v=Object(i.e)(function(e){return{getSessionToken:function(t){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e(Object(o.getSessionToken)({endpoint:t.endpoint||t.path,driveUrl:t.driveUrl}))];case 1:return[2,null!=(n=a.sent())?n:{accessToken:""}]}})})}}}),y=Object(i.e)(function(e){var t=e(c.e),n=e(Object(l.e)({graphDataRequestorConfiguration:f.t,graphTokenProvider:_.e,dataSyncClientConfiguration:u.e})),a=n.graphDataRequestorConfiguration,i=n.graphTokenProvider,o=n.dataSyncClientConfiguration,p=a&&a.alwaysSendContentType,h=a&&a.cookieOrigin;return{dataRequestor:new r.e({alwaysSendContentType:p},{cookieOrigin:h,apiEvent:d.e.withManager(t),sessionManagementProvider:i||e(v),isOffline:function(){return new m.n(function(t,n){try{var a=e(Object(s.n)()),i=void 0!==window.navigator.onLine&&!window.navigator.onLine;t(a||i)}catch(e){n(e)}})},dataSyncClient:null==o?void 0:o.dataSyncClient}),hasTokenProvider:!!i&&!!i.getSessionToken,hasDigestProvider:!!i&&!!i.getFormDigest,cookieOrigin:h}});function S(e){var t=this,n=e.url,i=e.method,r=void 0===i?"GET":i,s=e.body,c=e.qosName,d=e.endpoint,u=e.headers,f=void 0===u?{}:u,m=e.timeout,_=e.expectedErrors,b=e.driveUrl,v=e.driveId,D=e.parseResponse,I=e.allowCookies,x=e.useMultiPartIfSupported,C=e.apiVersion,O=e.allowEndpointRedirect,E=e.scenarioInfo,A=e.needsAuthorization,L=void 0===A||A,k=e.responseType;return function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,u,A,M,P,T,U,F,H,R,N,B,j,V,z,G,K,W,q,Q,Y,J,X,Z,$;return Object(a.__generator)(this,function(ee){switch(ee.label){case 0:return t=i(y),u=t.dataRequestor,A=t.hasTokenProvider,M=t.hasDigestProvider,P=t.cookieOrigin,T=void 0!==typeof s?JSON.stringify(s):void 0,U=new h.e(n).authority,F=P&&U&&P===U,H=i(Object(l.e)({clientName:p.t,enableUseMultiPart:p.h,isClaimsPerSiteEnabled:p.w,enableCookiesForSameDomain:p.d})),R=H.clientName,N=H.isClaimsPerSiteEnabled,B=H.enableUseMultiPart,j=H.enableCookiesForSameDomain,z=null!==(X=null!=I?I:j)&&void 0!==X&&X,G=z&&!!F&&("GET"===r||M),A||G?[3,2]:[4,i(Object(o.getSessionToken)({endpoint:d,driveUrl:b}))];case 1:V=ee.sent(),ee.label=2;case 2:K=void 0===B||B(d),W=O,q="".concat(f.Prefer?"".concat(f.Prefer,","):"","manualredirect"),ee.label=3;case 3:return ee.trys.push([3,5,,8]),[4,u.send({path:n,endpoint:d,driveUrl:b,driveId:v,requestType:r,apiName:c,accessToken:V,useAuthorizationHeaders:!0,needsAuthorization:L,postData:T,headers:Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},f),W?{Prefer:q}:{}),R?{"X-ClientService-ClientTag":R}:{}),N?{"x-ms-cc":"t"}:{}),i(w(E))),useMultiPart:K?x:void 0,expectedErrors:_,allowCookies:z,timeout:m,parseResponse:D,apiVersion:C,responseType:k})];case 4:return[2,ee.sent()];case 5:return Q=ee.sent(),W&&Q instanceof g.e&&"itemNotFound"===Q.code&&(null===($=null===(Z=Q.response)||void 0===Z?void 0:Z.error)||void 0===$?void 0:$["@error.redirectLocation"])?(Y=Q.response.error["@error.redirectLocation"],J=new h.e(Y).authority,n===Y?[3,7]:[4,i(S(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},e),{url:Y}),b?{driveUrl:"".concat(J).concat(new h.e(b).path)}:{}),d?{endpoint:"".concat(J).concat(new h.e(d).path)}:{})))]):[3,7];case 6:return[2,ee.sent()];case 7:throw Q;case 8:return[2]}})})}}function D(e){var t=this,n=e.url,i=e.method,r=void 0===i?"GET":i,o=e.body,c=e.qosName,d=e.timeout,l=e.endpoint,u=e.headers,f=e.expectedErrors,p=e.driveUrl,m=e.useMultiPartIfSupported,_=e.parseResponse,h=e.allowCookies,b=e.scenarioInfo;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,g,v,y,D,I,x;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=void 0!==typeof o?JSON.stringify(o):"",i=function(e,t,n){return e+"__"+t+"__"+(void 0!==n?n:"")}(n,r,t),g=e(Object(s.n)()),v=void 0!==window.navigator.onLine&&!window.navigator.onLine,y=g||v,[4,e(Object(s.t)(i))];case 1:return D=a.sent(),y&&D?[2,D]:(I=S({url:n,method:r,body:o,qosName:c,endpoint:l,headers:u,expectedErrors:f,timeout:d,driveUrl:p,useMultiPartIfSupported:m,parseResponse:_,allowCookies:h,scenarioInfo:b}),D?(e(I).then(function(t){e(Object(s.a)(i,t))}),[2,D]):[3,2]);case 2:return[4,e(I)];case 3:return x=a.sent(),[4,e(Object(s.a)(i,x))];case 4:return a.sent(),[2,x]}})})}}function I(e){return function(t){var n=t(Object(l.e)({isODCEndpoint:p.E})).isODCEndpoint;return!!n&&n(e)}}function x(e,t){var n=e.demandItemFacet(p.E,b.e);return!!n&&n(t)}function C(e,t){return function(n){var a=n(Object(l.e)({supportsRandomAccess:p.R})).supportsRandomAccess;return!!a&&a(e,t)}}function O(e,t){var n=e(Object(l.e)({graphEndpointConfiguration:p.S})).graphEndpointConfiguration;return!!n&&new h.e(n).authority.toLowerCase()===new h.e(t).authority.toLowerCase()}function w(e){return function(t){var n=t(Object(l.e)({clientName:p.t,addTelemetryHeadersConfiguration:f.e})),i=n.clientName;return n.addTelemetryHeadersConfiguration?Object(a.__assign)(Object(a.__assign)({},i?{Application:i}:{}),e?{Scenario:e.scenario,ScenarioType:e.scenarioType}:{}):{}}}},2341:function(e,t,n){"use strict";n.r(t),n.d(t,"getSessionToken",function(){return l});var a=n(0),i=n(1326),r=n(116),o=n(376),s=n(32),c=n(77),d=n(917);function l(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,l,f,p,m,_,h,b,g,v,y,S,D,I,x,C,O,w=this;return Object(a.__generator)(this,function(E){switch(E.label){case 0:if(t=e.scopes,l=void 0===t?["Files.ReadWrite.All"]:t,f=e.endpoint,p=e.driveUrl,m=e.qosExtraData,_=n(Object(r.e)({graphDataSourceConfiguration:i.e,graphTokenProviderConfiguration:d.e})),h=_.graphDataSourceConfiguration,b=_.graphTokenProviderConfiguration,g=h&&h.ensureAuthToken,v=p&&h&&h.ensureAuthTokenWithAction,y=b&&b.getSessionToken,D=y?function(){return Object(a.__awaiter)(w,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,y({endpoint:f,driveUrl:p,path:p||f})];case 1:return[2,e.sent()]}})})}:v?function(){return Object(a.__awaiter)(w,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n(v(l,f,p))];case 1:return[2,u(e.sent())]}})})}:g?function(){return Object(a.__awaiter)(w,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,g(l,f)];case 1:return[2,u(e.sent())]}})})}:void 0,!D)return[3,4];I=n(Object(o.e)({name:"graphDataSource.getAuthToken",extraData:m})),E.label=1;case 1:return E.trys.push([1,3,,4]),[4,D()];case 2:return S=E.sent(),n(I({resultType:s.t.Success,extraData:Object(a.__assign)(Object(a.__assign)({},m),{authTokenObtained:!!S})})),[3,4];case 3:throw x=E.sent(),C=s.t.Failure,O=void 0,x instanceof c.e?(x.isExpected&&(C=s.t.ExpectedFailure),O=x.code):O=x instanceof Error?"".concat(x.name,"(").concat(x.message,")"):"UnknownAuthError",n(I({resultType:C,resultCode:O,error:x&&JSON.stringify(x),extraData:m})),x;case 4:return[2,S]}})})}}function u(e){if(e)return{accessToken:e}}},2365:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"t",function(){return c});var a=n(1),i=new a.e("listMediaTransform"),r=new a.e("itemMediaTransform"),o=new a.e("mediaTransformThumbnailUrlGenerator"),s=new a.e("mediaTransformPdfUrlGenerator"),c=new a.e("itemOriginalContentThumbnailUrl")},2444:function(e,t,n){"use strict";n.d(t,"i",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"t",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"n",function(){return d});var a=n(5).e.isActivated("3D3E7B22-3495-4C3E-9B4B-DEACF3B98622","08/16/2023","Show name of the image in Image field editor instead of the server-generated one with suffix and prefix");function i(e){if(e){if("string"!=typeof e)return e;var t=void 0;try{t=JSON.parse(e)}catch(e){}if(t&&0!==Object.getOwnPropertyNames(t).length)return t}}var r=/{([^}]*)}/g,o={".accessToken":!0,".spItemUrl":!0};function s(e,t){var n=[];if(e){for(var a=void 0,i=0;a=r.exec(e);){var s=a[1],c=t[s]||"";a.index>i&&n.push(e.substring(i,a.index)),i=r.lastIndex,n.push(o[s]?encodeURIComponent(c):c)}i<e.length&&n.push(e.substring(i,e.length))}return n.join("")}function c(e){var t=e.indexOf("?version=");return t>0?e.substring(0,t):e}function d(e){if(a)return e;try{var t=/Reserved_ImageAttachment_\[[0-9]+\]_\[(.*)\]\[[0-9]+\]_\[(.*)\]\[[0-9]+\]_\[(.*)\]\.(.*)/gm.exec(e);return t&&t[2]?t[2]:e}catch(t){return e}}},3255:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(1).e)("driveItemResponse")},3457:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(9),i=n(377);function r(e,t){var n=e.demandItemFacet(a.m,t.itemKey),r=e.demandItemFacet(i.m,t.itemKey),o=((null==n?void 0:n.extension)||"").toLowerCase(),s=o&&"."===o[0]?o.substring(1):o;return("gif"===s||"svg"===s)&&!!r}},3711:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(1).e)("graphThumbnailSet")},3814:function(e,t,n){"use strict";function a(e){var t=e.serverRelativeItemUrl,n=e.dataRequestor,a=e.webApiUrl,i=e.duration,r=void 0===i?1:i,o=e.authToken,s=a;return s=(s=s.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t})).method("GetPreAuthorizedAccessUrl",r),n.getData({url:s.toString(),method:"GET",authToken:o,qosName:"ItemDataSource.getDownloadUrl"}).then(function(e){return e.d.GetPreAuthorizedAccessUrl})}n.d(t,"e",function(){return a})},3961:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(1).e)("hasThumbnailAuthTokenFacet")},4119:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(20),i=n(15),r=new a.e("thumbnailToken",{endpoint:i.e,driveId:i.t})},4120:function(e,t,n){"use strict";var a=n(110),i=n(924),r=n(32),o=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.prototype.hasValidUniversalPrintLicense=function(e){var t=e.endpoint,n=e.accessToken;return this._dataRequestor.send({path:"".concat(t,"/print/services"),requestType:"GET",apiName:"UPLicenseCheck",useAuthorizationHeaders:!0,hasContentType:!0,accessToken:n,expectedErrorCodes:{403:!0,AuthenticationError:!0}}).then(function(e){return!(!e||!e.value||0==e.value.length)}).catch(function(e){return!1})},e.prototype.getPrinterSharesList=function(e){var t,n=e.endpoint,a=e.accessToken,i=e.printSearchStr,r=e.fileType,o=e.topQueryOption,s=e.nextLink;if(s)t=s;else if(i){t="".concat(n,"/print/shares");var c=[],d=[];if(r&&c.push("capabilities/contentTypes/any(c:c eq '".concat(r,"')")),i){var l=i.toLowerCase();c.push("contains(tolower(displayName), '".concat(l,"')"))}0!==c.length&&d.push("$filter=".concat(c.reduce(function(e,t){return e+" and "+t}))),o&&d.push("$top=".concat(o)),0!==d.length&&(t=t+"?"+d.reduce(function(e,t){return e+"&"+t}))}else t="".concat(n,"/me/print/recentprintershares");return this._dataRequestor.send({path:t,requestType:"GET",apiName:i?"searchprintshares":"recentprintshares",useAuthorizationHeaders:!0,hasContentType:!0,accessToken:a}).then(function(e){return{printersList:e.value,nextLink:e["@odata.nextLink"]}})},e.prototype.getPrinterShare=function(e){var t=e.endpoint,n=e.accessToken,a=e.printerId;return this._dataRequestor.send({path:"".concat(t,"/print/shares/").concat(a,"?$select=id,displayName,defaults,capabilities,isAcceptingJobs"),requestType:"GET",apiName:"printshare",useAuthorizationHeaders:!0,hasContentType:!0,accessToken:n})},e.prototype.submitPrintJob=function(e){var t=this,n=e.endpoint,a=e.printerId,i=e.file,r=e.config,o=e.contentType,s=e.accessToken,c={endpoint:n,printerId:a,config:r,accessToken:s};return this.createPrintJob(c).then(function(e){var r={endpoint:n,printerId:a,jobId:e.id,documentId:e.documents[0].id,fileName:i.name,fileSize:i.size,contentType:o,accessToken:s};return t.createUploadSession(r).then(function(r){return t.uploadPrintJob({uploadSession:r,file:i}).then(function(){return t.startPrintJob({endpoint:n,printerId:a,jobId:e.id,accessToken:s})})})})},e.prototype.createPrintJob=function(e){var t=e.endpoint,n=e.printerId,a=e.config,i=e.accessToken,r={configuration:a};return this._dataRequestor.send({path:"".concat(t,"/print/shares/").concat(n,"/jobs"),requestType:"POST",apiName:"createprintjob",useAuthorizationHeaders:!0,hasContentType:!0,postData:JSON.stringify(r),accessToken:i,expectedErrorCodes:{415:!0}})},e.prototype.createUploadSession=function(e){var t=e.endpoint,n=e.printerId,a=e.jobId,i=e.documentId,r=e.fileName,o=e.fileSize,s=e.contentType,c=e.accessToken,d={properties:{contentType:s,documentName:r,size:o}};return this._dataRequestor.send({path:"".concat(t,"/print/shares/").concat(n,"/jobs/").concat(a,"/documents/").concat(i,"/createUploadSession"),requestType:"POST",apiName:"createprintuploadsession",useAuthorizationHeaders:!0,hasContentType:!0,postData:JSON.stringify(d),accessToken:c,expectedErrorCodes:{415:!0}})},e.prototype.uploadPrintJob=function(e){for(var t=e.uploadSession,n=e.file,i=0,r=[],o=t.uploadUrl;n.size>i;){var s=Math.min(n.size,i+1e6),c={"Content-Range":"bytes ".concat(i,"-").concat(s-1,"/").concat(n.size)},d=this.uploadFragment(o,c,n.slice(i,s,n.type));r.push(d),i=s}return a.n.serial(r)},e.prototype.uploadFragment=function(e,t,n){return function(){var o=new r.e({name:"uploadprintfilefragment"});return i.e.start({url:e,headers:t,method:"PUT",json:n,withCredentials:!1}).then(function(e){var t=JSON.parse(e.responseText);return o.end({resultType:r.t.Success}),t},function(e){var t,n,i,s=e.response&&JSON.parse(e.response),c=(null===(n=null===(t=null==s?void 0:s.error)||void 0===t?void 0:t.innererror)||void 0===n?void 0:n.code)||(null===(i=null==s?void 0:s.error)||void 0===i?void 0:i.code)||JSON.stringify(s);return o.end({resultType:r.t.Failure,resultCode:e.status.toString(),error:c,extraData:{message:null==s?void 0:s.error.message,details:JSON.stringify(e.response)}}),a.n.reject(e)})}},e.prototype.startPrintJob=function(e){var t=e.endpoint,n=e.printerId,a=e.jobId,i=e.accessToken;return this._dataRequestor.send({path:"".concat(t,"/print/shares/").concat(n,"/jobs/").concat(a,"/start"),requestType:"POST",apiName:"startprintjob",useAuthorizationHeaders:!0,hasContentType:!0,accessToken:i})},e}();t.e=o},4396:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(1).e)("hasPdfFacet")},4398:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(1).e)("thumbnailAccessToken")},4573:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(20),i=n(308),r=n(75),o=new a.e("driveItemUnauthenticatedThumbnail",{driveItemKey:r.e.subKeyPart,width:i.e,height:i.e})},4578:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"e",function(){return o});var a=n(1),i=new a.e("fileDownloadError"),r=new a.e("getFileDownloadUrlError"),o=new a.e("disabledDocumentConversionError")},5194:function(e,t,n){"use strict";n.d(t,"e",function(){return v}),n.d(t,"t",function(){return y});var a=n(0),i=n(9),r=n(189),o=n(75),s=n(3711),c=n(4119),d=n(4398),l=n(3961),u=n(3255),f=n(1969),p=n(158),m=n(806),_=n(208),h=n(3457),b=n(4573),g=n(377);function v(e,t){var n=t.itemKey,v=t.desiredSize,S=t.fitMode,D=t.requestOptions,I=e.demandItemFacet(o.e,n);if(!I)return{};var C=e.demandItemFacet(l.e,n)?function(e,t){var n=t.itemKey,a=t.desiredSize,i=t.fitMode,r=y(e.demandItemFacet(s.e,n));if(r&&r.large){var o=e.demandItemFacet(u.e,n),c=o&&(o["@microsoft.graph.downloadUrl"]||o["@content.downloadUrl"]),d=Object(h.e)(e,{itemKey:n});return{url:x(d&&c||r.large.url,a,i,d),width:0,height:0}}}(e,{itemKey:n,driveItem:I,desiredSize:v,fitMode:S}):function(e,t){var n,o=t.itemKey,s=t.driveItem,l=t.desiredSize,u=!!e.demandItemFacet(i.h,o),h=!!e.demandItemFacet(r.i,o);if(!u&&!h){if(!(null===(n=t.requestOptions)||void 0===n?void 0:n.allowsHeaders))return function(e,t){var n=t.driveItem,a=t.desiredSize,i=Math.ceil(a.width),r=Math.ceil(a.height),o=b.e.serialize({driveItemKey:{driveId:n.driveId,itemId:n.itemId,endpoint:n.endpoint},width:i,height:r}),s=e.demandItemFacet(g.h,o);return s?{url:s.url,height:i,width:r}:void 0}(e,{driveItem:s,desiredSize:l});var v=e.demandItemFacet(i.p,o,{suppressGetItems:!0})||"",y=new p.e(s.endpoint).authority,S=s.endpoint.indexOf("/v2.")>-1,D=Object(f.a)(e,s.endpoint),I="".concat(y,S&&!D?"/_api/v2.1":"/v1.0"),x=c.e.serialize({endpoint:I,driveId:s.driveId}),C=e.demandItemFacet(d.e,x);if(C){var O=Object(m.t)({endpoint:I,driveId:s.driveId,itemId:s.itemId}),w=Math.ceil(l.width),E=Math.ceil(l.height),A="".concat(O,"/thumbnails/0/c").concat(w,"x").concat(E,"/content"),L={prefer:"noredirect,closestavailablesize",cb:v},k=Object(a.__assign)(Object(a.__assign)({},L),{access_token:{uriValue:C}});return{url:"".concat(A,"?").concat(Object(_.e)(k)),width:w,height:E}}}}(e,{itemKey:n,driveItem:I,desiredSize:v,requestOptions:D});return C?{thumbnail:C}:{}}function y(e){return e&&(t=e)&&"number"==typeof t.length?e[0]:e;var t}var S=/width=[0-9]*/,D=/height=[0-9]*/,I=/cropmode=[a-z]*/;function x(e,t,n,a){if(a)return e;var i="cover"===n?"center":"none";I.test(e)?e=e.replace(I,"cropmode=".concat(i)):e+="".concat(e.indexOf("?")>-1?"&":"?","cropmode=").concat(i);var r="number"==typeof t.width?Math.ceil(t.width):t.width,o="number"==typeof t.height?Math.ceil(t.height):t.height,s="".concat(r||"");S.test(e)?e=e.replace(S,"width=".concat(s)):e+="".concat(e.indexOf("?")>-1?"&":"?","width=").concat(s);var c="".concat(o||"");return D.test(e)?e=e.replace(D,"height=".concat(c)):e+="".concat(e.indexOf("?")>-1?"&":"?","height=").concat(c),e}},5200:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(1).e)("universalPrintSharedPrinterListItem")},5771:function(e,t,n){"use strict";n.r(t),n.d(t,"CACHE_EXPIREATION_TIME",function(){return h}),n.d(t,"LICENSE_CACHE_KEY",function(){return b}),n.d(t,"universalPrintLicenseCheckOperationHandler",function(){return g});var a=n(0),i=n(44),r=n(116),o=n(16),s=n(1014),c=n(1527),d=n(733),l=n(91),u=n(1969),f=n(4120),p=n(2341),m=n(86),_=n(72),h=6048e5,b="licenseinfo",g=Object(o.i)()(function e(t){var n=this;return function(o){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,g,v,y,S,D,I,x,C,O,w,E,A;return Object(a.__generator)(this,function(L){switch(L.label){case 0:return n=t.itemKey,g=o(Object(r.e)({universalPrintLicenseCache:c.e})).universalPrintLicenseCache,void 0!==(v=null==g?void 0:g.getValue(b,_.e.local))&&((w=new i.e({publisher:e})).resolveItems({items:(E={},E[n]=Object(a.__assign)({},s.e.pack(v.hasValidLicense)),E)}),o(w.execute())),void 0===v||!v.lastModified||!v.hasValidLicense&&Date.now()-v.lastModified>=h?(y=o(Object(r.e)({graphEndpoint:l.S})).graphEndpoint,S=o(u.e).dataRequestor,D=new f.e({},{dataRequestor:S}),I=d.e.deserialize(n),x=y||I.graphEndpoint,[4,o(Object(p.getSessionToken)({endpoint:x}))]):[3,3];case 1:return C=L.sent(),[4,D.hasValidUniversalPrintLicense({endpoint:x,accessToken:C})];case 2:O=L.sent(),m.e.logData({name:"UniversalPrint.LicenseInfo",extraData:{hasValidLicense:O}}),g&&g.setValue(b,{hasValidLicense:O,lastModified:Date.now()},_.e.local),(null==v?void 0:v.hasValidLicense)!==O&&((w=new i.e({publisher:e})).resolveItems({items:(A={},A[n]=Object(a.__assign)({},s.e.pack(O)),A)}),o(w.execute())),L.label=3;case 3:return[2]}})})}})},5772:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d});var a=n(0),i=n(295),r=n(382),o=n(807),s=n(4578),c=function(e,t,n){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var i,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,fetch(e,{mode:"cors"})];case 1:return(i=a.sent()).ok?[4,i.blob()]:[3,3];case 2:return o=a.sent(),[2,new File([o],t,{type:n})];case 3:throw new r.e({facets:s.t.pack(i.status)})}})})},d=function(e){var t=Object(o.t)(e,function(e,t){switch(e){case"unauthenticated":case"401":case 401:return i.a.pack({});case"itemNotFound":case"404":case 404:return i.p.pack({});case"accessDenied":case"403":case 403:return i.e.pack({});case"415":case 415:return s.e.pack({});case"offline":return i.v.pack({})}});throw new r.e({innerError:e,facets:t})}},6900:function(e,t,n){"use strict";n.r(t),n.d(t,"universalPrintPrinterShareListOperationHandler",function(){return u});var a=n(0),i=n(44),r=n(16),o=n(5200),s=n(1969),c=n(4120),d=n(1580),l=n(2341),u=Object(r.i)()(function e(t){var n=this;return function(r){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,u,f,p,m,_,h,b,g,v,y;return Object(a.__generator)(this,function(S){switch(S.label){case 0:return n=t.itemKey,u=r(s.e).dataRequestor,f=new c.e({},{dataRequestor:u}),p=d.e.deserialize(n),m=p.endpoint,_=p.printSearchStr,h=p.fileType,[4,r(Object(l.getSessionToken)({endpoint:m}))];case 1:return b=S.sent(),[4,f.getPrinterSharesList({endpoint:m,accessToken:b,printSearchStr:_,fileType:h,topQueryOption:100})];case 2:return g=S.sent(),(v=new i.e({publisher:e})).resolveItems({items:(y={},y[n]=Object(a.__assign)({},o.e.pack(g)),y)}),r(v.execute()),[2]}})})}})},6901:function(e,t,n){"use strict";n.r(t),n.d(t,"itemGetPrintFileUrlOperationHandler",function(){return _});var a=n(0),i=n(16),r=n(75),o=n(624),s=n(145),c=n(44),d=n(713),l=n(806),u=n(1969),f=n(4396),p=n(5194),m=n(3711),_=Object(i.i)()(function e(t){var n=this;return function(i){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,_,h,b,g,v,y,S,D,I,x,C,O,w,E,A;return Object(a.__generator)(this,function(L){switch(L.label){case 0:return n=t.itemKey,_=i(Object(s.e)(function(e){return{hasPdf:e.demandItemFacet(f.e,n),thumbnailSet:e.demandItemFacet(m.e,n)}})),h=_.hasPdf,b=_.thumbnailSet,g=Object(p.t)(b),h&&g?(y=Object(d.n)(g.large.url),v={fileUrl:y},[3,3]):[3,1];case 1:return(S=i(Object(s.e)(function(e){return e.demandItem({driveItemKey:r.e},n)})).driveItemKey)?(D=Object(l.t)(S),I=Object(l.n)(S),x=S.endpoint,C=S.driveId,[4,i(Object(u.t)({url:D,driveUrl:I,driveId:C,method:"GET",qosName:"getItemPrintFileDataUrl",endpoint:x}))]):[2];case 2:if(O=L.sent(),w=function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}(D)?O["@microsoft.graph.downloadUrl"]:O["@content.downloadUrl"],!w)throw new Error("Unable to obtain Print file URL.");v={fileUrl:w},L.label=3;case 3:return(E=new c.e({publisher:e})).resolveItems({items:(A={},A[n]=Object(a.__assign)({},o.n.pack(v)),A)}),i(E.execute()),[2]}})})}})},6902:function(e,t,n){"use strict";n.r(t),n.d(t,"printToUniversalPrinterOperationHandler",function(){return g});var a=n(0),i=n(16),r=n(9),o=n(116),s=n(145),c=n(382),d=n(807),l=n(4120),u=n(713),f=n(91),p=n(4578),m=n(624),_=n(2341),h=n(1969),b=n(5772),g=Object(i.i)()(function(e){var t=e.itemKey,n=e.options,i=n.printerId,g=n.config;return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,v,y,S,D,I,x,C,O,w,E,A,L;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(!(n=e(Object(o.e)({graphEndpoint:f.S})).graphEndpoint))throw new c.e({code:"missingendpointinfoforprinttoup"});return[4,e(Object(_.getSessionToken)({endpoint:n}))];case 1:v=a.sent(),y=e(h.e).dataRequestor,S=new l.e({},{dataRequestor:y}),a.label=2;case 2:a.trys.push([2,11,,12]),a.label=3;case 3:return a.trys.push([3,5,,6]),[4,e(Object(m.e)({items:(L={},L[t]={},L)}))];case 4:return a.sent(),[3,6];case 5:throw D=a.sent(),new c.e({facets:p.n.pack({}),innerError:D});case 6:if(I=e(Object(s.e)(function(e){return{fileName:e.demandItemFacet(r.m,t),printFileData:e.demandItemFacet(m.n,t)}})),x=I.fileName,!(C=I.printFileData)||!x||!C.file&&!C.fileUrl)throw new c.e({code:"missingfileinforprinttoup"});return O=void 0,C.fileUrl?(w=Object(u.i)(x.extension)?u.e:u.t,[4,Object(b.e)(C.fileUrl,x.name,w)]):[3,8];case 7:return O=a.sent(),[3,9];case 8:if(!C.file)throw new c.e({code:"missingfileinforprinttoup"});O=C.file,a.label=9;case 9:return E={endpoint:n,printerId:i,file:O,contentType:O.type,config:g,accessToken:v},[4,S.submitPrintJob(E)];case 10:return a.sent(),[3,12];case 11:if(!((A=a.sent())instanceof d.e))throw A;return Object(b.t)(A),[3,12];case 12:return[2]}})})}})},6903:function(e,t,n){"use strict";n.r(t),n.d(t,"printToUniversalPrinterOperationHandler",function(){return g});var a=n(0),i=n(16),r=n(9),o=n(145),s=n(382),c=n(807),d=n(4120),l=n(624),u=n(2341),f=n(1969),p=n(5772),m=n(116),_=n(91),h=n(4578),b=n(713),g=Object(i.i)()(function(e){var t=e.itemKey,n=e.options,i=n.printerId,g=n.config;return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,v,y,S,D,I,x,C,O,w,E,A,L;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(!(n=e(Object(m.e)({graphEndpoint:_.S})).graphEndpoint))throw new s.e({code:"missinggraphendpointinfoforprinttoup"});return[4,e(Object(u.getSessionToken)({endpoint:n}))];case 1:v=a.sent(),y=e(f.e).dataRequestor,S=new d.e({},{dataRequestor:y}),a.label=2;case 2:a.trys.push([2,11,,12]),a.label=3;case 3:return a.trys.push([3,5,,6]),[4,e(Object(l.e)({items:(L={},L[t]={},L)}))];case 4:return a.sent(),[3,6];case 5:throw D=a.sent(),new s.e({facets:h.n.pack({}),innerError:D});case 6:if(I=e(Object(o.e)(function(e){return{fileName:e.demandItemFacet(r.m,t),printFileData:e.demandItemFacet(l.n,t)}})),x=I.fileName,C=I.printFileData,!x||!C||!C.file&&!C.fileUrl)throw new s.e({code:"missingfileinforprinttoup"});return O=void 0,C.fileUrl?(w=Object(b.i)(x.extension)?b.e:b.t,[4,Object(p.e)(C.fileUrl,x.name,w)]):[3,8];case 7:return O=a.sent(),[3,9];case 8:if(!C.file)throw new s.e({code:"missingfileinforprinttoup"});O=C.file,a.label=9;case 9:return E={endpoint:n,printerId:i,file:O,contentType:O.type,config:g,accessToken:v},[4,S.submitPrintJob(E)];case 10:return a.sent(),[3,12];case 11:if(!((A=a.sent())instanceof c.e))throw A;return Object(p.t)(A),[3,12];case 12:return[2]}})})}})},7076:function(e,t,n){"use strict";n.r(t),n.d(t,"driveItemDeleteItemsBatchedOperationHandler",function(){return g});var a,i=n(0),r=n(382),o=n(16),s=n(456),c=n(141),d=n(62),l=n(112),u=n(592),f=n(9),p=n(75),m=n(806),_=n(1969),h=n(295);!function(e){e.Completed="completed",e.Failed="failed",e.InProgress="inProgress"}(a||(a={}));var b=3e5,g=Object(o.n)({maxParallelOperationCount:4,timeout:b,areSameBatch:function(e,t){var n=p.e.deserialize(e.itemKey).driveId,a=p.e.deserialize(t.itemKey).driveId;return!!n&&!!a&&n===a}})(function(e){var t=this,n=e.items,g=Object.keys(n),v=g.map(function(e){return p.e.deserialize(e)});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,p,y,S,D,I,x,C;return Object(i.__generator)(this,function(O){switch(O.label){case 0:return e(Object(l.e)({items:Object(c.t)(n,function(e){return e.progressItemKey,Object(i.__assign)(Object(i.__assign)({},d.v.pack({total:1,current:0})),d.p.pack(!0))},function(e,t){return t.progressItemKey})})),t={value:v.map(function(e){return{id:e.itemId,deleted:{}}})},p="",y=Object(m.n)(v[0]),S=v[0].driveId,[4,e(Object(_.t)({url:"".concat(y,"/items"),method:"PATCH",body:t,qosName:"deleteItems",endpoint:v[0].endpoint,driveId:S,parseResponse:function(e){p=e.getResponseHeader("Location")||""}}))];case 1:O.sent(),D=0,I=!1,x=!1,Object(s.t)(b).then(function(){return x=!0}),C=function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(_.t)({url:p,qosName:"getOperationStatus",endpoint:v[0].endpoint,driveId:S}))];case 1:return t=i.sent(),g.forEach(function(){e(Object(l.e)({items:Object(c.t)(n,function(e){return e.progressItemKey,d.v.pack({total:1,current:t.percentageComplete/g.length})},function(e,t){return t.progressItemKey})}))}),t.status!==a.Completed&&t.status!==a.Failed?[3,2]:(I=!0,D=t.summary.failed,[3,4]);case 2:return[4,Object(s.t)(500)];case 3:i.sent(),i.label=4;case 4:return[2]}})},O.label=2;case 2:return[5,C()];case 3:O.sent(),O.label=4;case 4:if(!I&&!x)return[3,2];O.label=5;case 5:if(x)throw new r.e({facets:Object(i.__assign)({},h.u.pack(408))});if(e(Object(u.t)({items:Object(c.e)(g,function(){return[f.l]})})),D>0)throw new o.e({items:Object(c.e)(g.slice(0,D),function(){return new r.e({facets:Object(i.__assign)({},h.u.pack(500))})})});return[2]}})})}})},7485:function(e,t,n){"use strict";n.r(t),n.d(t,"spItemPdfGetItemsOperationHandler",function(){return m});var a=n(0),i=n(1201),r=n(44),o=n(2365),s=n(16),c=n(45),d=n(339),l=n(2444);function u(e){var t=e.listMediaTransformSchema,n=e.itemMediaTransformSchema;if(t&&n){var i=t[".transformUrl"],r=n[".hasPdf"],o=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},t),n),{".method":"pdf"});if("True"===r&&i)return function(){return"".concat(Object(l.t)(i,o))}}}var f=n(592),p=n(1581),m=Object(s.i)({maxParallelOperationCount:16})(function(e){var t=this,n=p.e.deserialize(e.itemKey).itemKey;return function(s){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,l,p,m;return Object(a.__generator)(this,function(_){switch(_.label){case 0:return[4,s(Object(i.e)(function(e){var t=e.demandItemFacet(c.e,n),a=t&&d.e.serialize(t);return{generator:u({listMediaTransformSchema:e.demandItemFacet(o.n,a),itemMediaTransformSchema:e.demandItemFacet(o.e,n)})}}))];case 1:return t=_.sent().generator,(l=new r.e).resolveItems(((p={items:(m={},m[e.itemKey]=Object(a.__assign)({},o.a.pack(t)),m)})[n]=Object(a.__assign)({},Object(f.e)().forFacet(o.e).thenInvalidate(e.itemKey,o.a).pack()),p)),s(l.execute()),[2]}})})}})},7486:function(e,t,n){"use strict";n.r(t),n.d(t,"spItemGetPrintFileUrlOperationHandler",function(){return y});var a=n(0),i=n(16),r=n(45),o=n(788),s=n(3),c=n(145),d=n(426),l=n(3814),u=n(233),f=n(624),p=n(44),m=n(9),_=n(138),h=n(2365),b=n(1581),g=new _.e("pdfUrlGenerator",function(e,t){var n=t.itemKey;return n&&e.demandItemFacet(h.a,b.e.serialize({itemKey:n}))||void 0}),v=n(1201),y=Object(i.i)()(function e(t){var n=this;return function(i){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,d,l,u,_,h,b,y,D,I,x,C,O,w,E;return Object(a.__generator)(this,function(A){switch(A.label){case 0:return n=t.itemKey,d=i(Object(c.e)(function(e){return e.demandItem({spItemKey:r.e,folderPath:s.be,fileName:m.m},n)})),l=d.spItemKey,u=d.folderPath,_=d.fileName,[4,i(Object(v.e)(function(e){return e.demandItem({pdfUrlGenerator:g},n)}))];case 1:return h=A.sent().pdfUrlGenerator,b=l&&o.e.serialize(l),(y=i(Object(c.e)(function(e){return{pageContext:e.demandItemFacet(s.In,b)}})).pageContext)&&l&&_&&u?(D=l.webAbsoluteUrl,I=l.listFullUrl,x=y.layoutsUrl,C=_.extension,[4,i(S({webAbsoluteUrl:D,listFullUrl:I,folderPath:u,layoutsUrl:x,extension:C,pdfGenerator:h}))]):[2];case 2:return O=A.sent(),(w=new p.e({publisher:e})).resolveItems({items:(E={},E[n]=Object(a.__assign)({},f.n.pack(O)),E)}),i(w.execute()),[2]}})})}});function S(e){var t=this,n=e.webAbsoluteUrl,i=e.listFullUrl,r=e.folderPath,o=e.extension,s=e.pdfGenerator;return".oxps"===o||".xps"===o||".pdf"===o?function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,o,s,c,f,p;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=e(Object(u.n)({webAbsoluteUrl:n,listFullUrl:i})),o=t.dataRequestor,s=t.hasDigest,t.hasTokenProvider?(f=void 0,[3,3]):[3,1];case 1:return[4,e(Object(u.e)({url:n||i,disallowCookies:!s}))];case 2:f=a.sent(),a.label=3;case 3:return c=f,p=Object(d.i)({webAbsoluteUrl:n,listOrItemFullUrl:i}),[4,Object(l.e)({dataRequestor:o,authToken:c,serverRelativeItemUrl:r,webApiUrl:p})];case 4:return[2,{fileUrl:a.sent()}]}})})}:function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,{fileUrl:s&&s()}]})})}}}}]);